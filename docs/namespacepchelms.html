<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: pchelms Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacepchelms.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">pchelms Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file solves the helmholtz equation to set inital fields that match vmec and vacuum currents from the vector potential. Initial vector potential on the edge is supplied by the BMW code.  
<a href="namespacepchelms.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2c9081a3fa287a5c82639d814e12a54f" id="r_a2c9081a3fa287a5c82639d814e12a54f"><td class="memItemLeft" align="right" valign="top"><a id="a2c9081a3fa287a5c82639d814e12a54f" name="a2c9081a3fa287a5c82639d814e12a54f"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>run_pchelms</b></td></tr>
<tr class="memdesc:a2c9081a3fa287a5c82639d814e12a54f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the pchelms code to solve for inital jbsup values. <br /></td></tr>
<tr class="separator:a2c9081a3fa287a5c82639d814e12a54f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922087e4385eb59f4f0a758dd67d4f65" id="r_a922087e4385eb59f4f0a758dd67d4f65"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a922087e4385eb59f4f0a758dd67d4f65">curla_pchelms</a> (asubsmnf, asubumnf, asubvmnf,</td></tr>
<tr class="memdesc:a922087e4385eb59f4f0a758dd67d4f65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute real-space components of contravariant jac*B^i on half radial grid from curl(A).  <br /></td></tr>
<tr class="separator:a922087e4385eb59f4f0a758dd67d4f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c588539b11ef597d1f30c6397af78a6" id="r_a5c588539b11ef597d1f30c6397af78a6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a5c588539b11ef597d1f30c6397af78a6">curlb_pchelms</a> (ksupsmnf, ksupumnf, ksupvmnf, asubsmnf,</td></tr>
<tr class="memdesc:a5c588539b11ef597d1f30c6397af78a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute real-space components of contravariant jac*J^i on full radial grid from curl(B).  <br /></td></tr>
<tr class="separator:a5c588539b11ef597d1f30c6397af78a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a7777aa698273d7fcd45f747bd96198" id="r_a9a7777aa698273d7fcd45f747bd96198"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a9a7777aa698273d7fcd45f747bd96198">cyl2vmec_a</a> (a_r, a_p, a_z, ca_s, ca_u, ca_v)</td></tr>
<tr class="memdesc:a9a7777aa698273d7fcd45f747bd96198"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert cylindical vector potential to contravariant components.  <br /></td></tr>
<tr class="separator:a9a7777aa698273d7fcd45f747bd96198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055dc5013104e1119dcfd6c8b99b65c6" id="r_a055dc5013104e1119dcfd6c8b99b65c6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a055dc5013104e1119dcfd6c8b99b65c6">get_e_s</a> (rij_h, zij_h, rs, zs, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a055dc5013104e1119dcfd6c8b99b65c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the e_s basis vector.  <br /></td></tr>
<tr class="separator:a055dc5013104e1119dcfd6c8b99b65c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5707a04437dd9afd3383487a26daa5b1" id="r_a5707a04437dd9afd3383487a26daa5b1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a5707a04437dd9afd3383487a26daa5b1">init_a</a> (ca_s, ca_u, ca_v, a_s, a_u, a_v, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a5707a04437dd9afd3383487a26daa5b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize vector potential.  <br /></td></tr>
<tr class="separator:a5707a04437dd9afd3383487a26daa5b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c488e4e5d6dc07e7bb63eccd038463" id="r_a86c488e4e5d6dc07e7bb63eccd038463"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a86c488e4e5d6dc07e7bb63eccd038463">init_f</a> (fsupsmn, fsupumn, fsupvmn, jcurrumn, jcurrvmn, p</td></tr>
<tr class="memdesc:a86c488e4e5d6dc07e7bb63eccd038463"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize expected currents.  <br /></td></tr>
<tr class="separator:a86c488e4e5d6dc07e7bb63eccd038463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10637cb6e3d7fd0301c92ca837628769" id="r_a10637cb6e3d7fd0301c92ca837628769"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a10637cb6e3d7fd0301c92ca837628769">compare_current</a> (fsupsmn, fsupumn, fsupvmn, jcurrumn, jc</td></tr>
<tr class="memdesc:a10637cb6e3d7fd0301c92ca837628769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare Curl(Curl(A)) with the expected VMEC and vacuum currents.  <br /></td></tr>
<tr class="separator:a10637cb6e3d7fd0301c92ca837628769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fde1f18d2db817c31be925702ca27a" id="r_a11fde1f18d2db817c31be925702ca27a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a11fde1f18d2db817c31be925702ca27a">dump_b</a> (js, iunit)</td></tr>
<tr class="memdesc:a11fde1f18d2db817c31be925702ca27a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out magnetic field to file.  <br /></td></tr>
<tr class="separator:a11fde1f18d2db817c31be925702ca27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a225289b1f437428784e431152a2f2" id="r_aa3a225289b1f437428784e431152a2f2"><td class="memItemLeft" align="right" valign="top"><a id="aa3a225289b1f437428784e431152a2f2" name="aa3a225289b1f437428784e431152a2f2"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>getfsq_pchelms</b></td></tr>
<tr class="memdesc:aa3a225289b1f437428784e431152a2f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The the current residual. <br /></td></tr>
<tr class="separator:aa3a225289b1f437428784e431152a2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03bada0ad4661ef892054eddba4279c5" id="r_a03bada0ad4661ef892054eddba4279c5"><td class="memItemLeft" align="right" valign="top"><a id="a03bada0ad4661ef892054eddba4279c5" name="a03bada0ad4661ef892054eddba4279c5"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>cleanup</b></td></tr>
<tr class="memdesc:a03bada0ad4661ef892054eddba4279c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate arrays. <br /></td></tr>
<tr class="separator:a03bada0ad4661ef892054eddba4279c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7fc7b067cc3b6ee467368fd4be9ef68" id="r_ab7fc7b067cc3b6ee467368fd4be9ef68"><td class="memItemLeft" align="right" valign="top"><a id="ab7fc7b067cc3b6ee467368fd4be9ef68" name="ab7fc7b067cc3b6ee467368fd4be9ef68"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>check_current</b></td></tr>
<tr class="memdesc:ab7fc7b067cc3b6ee467368fd4be9ef68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that the line integral of Bsubuij equals the integrated toroidal current. <br /></td></tr>
<tr class="separator:ab7fc7b067cc3b6ee467368fd4be9ef68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92c8f2b18acd0ab05820b19beb32b73" id="r_ab92c8f2b18acd0ab05820b19beb32b73"><td class="memItemLeft" align="right" valign="top"><a id="ab92c8f2b18acd0ab05820b19beb32b73" name="ab92c8f2b18acd0ab05820b19beb32b73"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>compute_forces_lin</b></td></tr>
<tr class="memdesc:ab92c8f2b18acd0ab05820b19beb32b73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute linear forces. <br /></td></tr>
<tr class="separator:ab92c8f2b18acd0ab05820b19beb32b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59257cee16eee714e41df5a755e5db8d" id="r_a59257cee16eee714e41df5a755e5db8d"><td class="memItemLeft" align="right" valign="top"><a id="a59257cee16eee714e41df5a755e5db8d" name="a59257cee16eee714e41df5a755e5db8d"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>backslv</b></td></tr>
<tr class="memdesc:a59257cee16eee714e41df5a755e5db8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update solution. <br /></td></tr>
<tr class="separator:a59257cee16eee714e41df5a755e5db8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8943c1709ac343912f095a522c2f40" id="r_a6b8943c1709ac343912f095a522c2f40"><td class="memItemLeft" align="right" valign="top"><a id="a6b8943c1709ac343912f095a522c2f40" name="a6b8943c1709ac343912f095a522c2f40"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>init_pchelms</b></td></tr>
<tr class="memdesc:a6b8943c1709ac343912f095a522c2f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize helmholtz solver. <br /></td></tr>
<tr class="separator:a6b8943c1709ac343912f095a522c2f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3e9157fb69427566b03fe6e032cdae" id="r_a1e3e9157fb69427566b03fe6e032cdae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a1e3e9157fb69427566b03fe6e032cdae">compute_forces</a> (lnlinear)</td></tr>
<tr class="memdesc:a1e3e9157fb69427566b03fe6e032cdae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Fourier components of Curl(Curl(A)) - mu0J operator on full radial grid.  <br /></td></tr>
<tr class="separator:a1e3e9157fb69427566b03fe6e032cdae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8066d5727b43d7321a0f4948dc64cbe" id="r_aa8066d5727b43d7321a0f4948dc64cbe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#aa8066d5727b43d7321a0f4948dc64cbe">boundaryconditions</a> (fsupsmn, fsupumn, fsupvmn, iparity)</td></tr>
<tr class="memdesc:aa8066d5727b43d7321a0f4948dc64cbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply boundary conditions.  <br /></td></tr>
<tr class="separator:aa8066d5727b43d7321a0f4948dc64cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835b9933774c798db9d3af83abd8f811" id="r_a835b9933774c798db9d3af83abd8f811"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a835b9933774c798db9d3af83abd8f811">gmres_pchelms</a></td></tr>
<tr class="memdesc:a835b9933774c798db9d3af83abd8f811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup and run GMRES solver for the helmholtz problem.  <br /></td></tr>
<tr class="separator:a835b9933774c798db9d3af83abd8f811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0114f3b63cccd456307e00fd6a5d21b" id="r_ac0114f3b63cccd456307e00fd6a5d21b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#ac0114f3b63cccd456307e00fd6a5d21b">matvec_pchelms</a> (p, ap, ndim)</td></tr>
<tr class="memdesc:ac0114f3b63cccd456307e00fd6a5d21b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serial callback function for MatVec GMRES routine.  <br /></td></tr>
<tr class="separator:ac0114f3b63cccd456307e00fd6a5d21b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e06d110f4fab7bfe69ead5a415571b" id="r_a94e06d110f4fab7bfe69ead5a415571b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a94e06d110f4fab7bfe69ead5a415571b">matvec_par_pchelms</a> (ploc, ap, nloc)</td></tr>
<tr class="memdesc:a94e06d110f4fab7bfe69ead5a415571b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallel callback function for MatVec GMRES routine.  <br /></td></tr>
<tr class="separator:a94e06d110f4fab7bfe69ead5a415571b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad89a7b4e5adb8613efe6fa04700598a" id="r_aad89a7b4e5adb8613efe6fa04700598a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#aad89a7b4e5adb8613efe6fa04700598a">getnlforce_pchelms</a> (xcstate, fsq_nl, bnorm)</td></tr>
<tr class="memdesc:aad89a7b4e5adb8613efe6fa04700598a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non linear force callback.  <br /></td></tr>
<tr class="separator:aad89a7b4e5adb8613efe6fa04700598a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file solves the helmholtz equation to set inital fields that match vmec and vacuum currents from the vector potential. Initial vector potential on the edge is supplied by the BMW code. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa8066d5727b43d7321a0f4948dc64cbe" name="aa8066d5727b43d7321a0f4948dc64cbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8066d5727b43d7321a0f4948dc64cbe">&#9670;&#160;</a></span>boundaryconditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::boundaryconditions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fsupsmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fsupumn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fsupvmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iparity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply boundary conditions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Fsupsmn</td><td>Contravariant current in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Fsupumn</td><td>Contravariant current in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Fsupvmn</td><td>Contravariant current in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iparity</td><td>Fourier parity of the residuals. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a10637cb6e3d7fd0301c92ca837628769" name="a10637cb6e3d7fd0301c92ca837628769"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10637cb6e3d7fd0301c92ca837628769">&#9670;&#160;</a></span>compare_current()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::compare_current </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>fsupsmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>fsupumn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>fsupvmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>jcurrumn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compare Curl(Curl(A)) with the expected VMEC and vacuum currents. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Fsupsmn</td><td>Contravariant current in the s direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Fsupumn</td><td>Contravariant current in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Fsupvmn</td><td>Contravariant current in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jcurrumn</td><td>Contravariant VMEC current in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jcurrvmn</td><td>Contravariant VMEC current in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iparity</td><td>Parity flag to indicate stellaratory symmetry. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1e3e9157fb69427566b03fe6e032cdae" name="a1e3e9157fb69427566b03fe6e032cdae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3e9157fb69427566b03fe6e032cdae">&#9670;&#160;</a></span>compute_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::compute_forces </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lnlinear</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Fourier components of Curl(Curl(A)) - mu0J operator on full radial grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lNLinear</td><td>Use Non linear equations. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a922087e4385eb59f4f0a758dd67d4f65" name="a922087e4385eb59f4f0a758dd67d4f65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922087e4385eb59f4f0a758dd67d4f65">&#9670;&#160;</a></span>curla_pchelms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::curla_pchelms </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>asubsmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>asubumnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>asubvmnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute real-space components of contravariant jac*B^i on half radial grid from curl(A). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Asubsmnf</td><td>Covariant vector potential in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asubumnf</td><td>Covariant vector potential in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asubvmnf</td><td>Covariant vector potential in the v direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbsupsmnh</td><td>Contravariant B field and jacobian in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbsupumnh</td><td>Contravariant B field and jacobian in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbsupvmnh</td><td>Contravariant B field and jacobian in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag to indicate stellaratory symmetry. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5c588539b11ef597d1f30c6397af78a6" name="a5c588539b11ef597d1f30c6397af78a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c588539b11ef597d1f30c6397af78a6">&#9670;&#160;</a></span>curlb_pchelms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::curlb_pchelms </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:,:,:), pointer&#160;</td>
          <td class="paramname"><em>ksupsmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), pointer&#160;</td>
          <td class="paramname"><em>ksupumnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), pointer&#160;</td>
          <td class="paramname"><em>ksupvmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), pointer&#160;</td>
          <td class="paramname"><em>asubsmnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute real-space components of contravariant jac*J^i on full radial grid from curl(B). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupsmnf</td><td>Contravariant current and jacobian in the s direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupumnf</td><td>Contravariant current and jacobian in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupvmnf</td><td>Contravariant current and jacobian in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">asubsmnf</td><td>Covariant vector potential in the s direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupsmnh</td><td>Contravariant current and jacobian in the v direction on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iparity</td><td>Parity flag to indicate stellaratory symmetry. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">curtor</td><td>Current enclosed at the boundary. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9a7777aa698273d7fcd45f747bd96198" name="a9a7777aa698273d7fcd45f747bd96198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a7777aa698273d7fcd45f747bd96198">&#9670;&#160;</a></span>cyl2vmec_a()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::cyl2vmec_a </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>a_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>a_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>a_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>ca_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>ca_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>ca_v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert cylindical vector potential to contravariant components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">A_r</td><td>Cylindical r component of the vector potential at the last surface. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">A_p</td><td>Cylindical p component of the vector potential at the last surface. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">A_z</td><td>Cylindical z component of the vector potential at the last surface. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cA_s</td><td>Contravariant vector potential in the s direction on the last surface grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cA_u</td><td>Contravariant vector potential in the u direction on the last surface grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cA_v</td><td>Contravariant vector potential in the v direction on the last surface grid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a11fde1f18d2db817c31be925702ca27a" name="a11fde1f18d2db817c31be925702ca27a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11fde1f18d2db817c31be925702ca27a">&#9670;&#160;</a></span>dump_b()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::dump_b </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iunit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write out magnetic field to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">js</td><td>Radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iunit</td><td>File unit to write to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a055dc5013104e1119dcfd6c8b99b65c6" name="a055dc5013104e1119dcfd6c8b99b65c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a055dc5013104e1119dcfd6c8b99b65c6">&#9670;&#160;</a></span>get_e_s()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::get_e_s </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rij_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>zij_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>rs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>zs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the e_s basis vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rij_h</td><td>Real space R on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zij_h</td><td>Real space Z on the half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rs</td><td>R' on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">zs</td><td>Z' on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aad89a7b4e5adb8613efe6fa04700598a" name="aad89a7b4e5adb8613efe6fa04700598a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad89a7b4e5adb8613efe6fa04700598a">&#9670;&#160;</a></span>getnlforce_pchelms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::getnlforce_pchelms </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(neqs), intent(in)&#160;</td>
          <td class="paramname"><em>xcstate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), intent(out)&#160;</td>
          <td class="paramname"><em>fsq_nl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), intent(in)&#160;</td>
          <td class="paramname"><em>bnorm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Non linear force callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xcstate</td><td>Displacement parameters. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fsq_nl</td><td>|F^2| non-linear residual. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bnorm</td><td>Internal GMRES normalization </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a835b9933774c798db9d3af83abd8f811" name="a835b9933774c798db9d3af83abd8f811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835b9933774c798db9d3af83abd8f811">&#9670;&#160;</a></span>gmres_pchelms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::gmres_pchelms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup and run GMRES solver for the helmholtz problem. </p>
<p>GMRES solves r == b + Ax = 0 </p>

</div>
</div>
<a id="a5707a04437dd9afd3383487a26daa5b1" name="a5707a04437dd9afd3383487a26daa5b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5707a04437dd9afd3383487a26daa5b1">&#9670;&#160;</a></span>init_a()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::init_a </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>ca_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>ca_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>ca_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(0:mpol,-ntor:ntor,ns), intent(out)&#160;</td>
          <td class="paramname"><em>a_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(0:mpol,-ntor:ntor,ns), intent(out)&#160;</td>
          <td class="paramname"><em>a_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(0:mpol,-ntor:ntor,ns), intent(out)&#160;</td>
          <td class="paramname"><em>a_v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize vector potential. </p>
<p>This subroutine is only called once so no need to parallelize. Linearly extrapolat to the center or match surface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cA_s</td><td>Contravariant vector potential in the s direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cA_u</td><td>Contravariant vector potential in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cA_v</td><td>Contravariant vector potential in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A_s</td><td>Contravariant fourier vector potential in the s direction on the full grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A_u</td><td>Contravariant fourier vector potential in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A_v</td><td>Contravariant fourier vector potential in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag to indicate stellaratory symmetry. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a86c488e4e5d6dc07e7bb63eccd038463" name="a86c488e4e5d6dc07e7bb63eccd038463"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c488e4e5d6dc07e7bb63eccd038463">&#9670;&#160;</a></span>init_f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::init_f </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(0:mpol,-ntor:ntor,ns), intent(out)&#160;</td>
          <td class="paramname"><em>fsupsmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(0:mpol,-ntor:ntor,ns), intent(out)&#160;</td>
          <td class="paramname"><em>fsupumn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(0:mpol,-ntor:ntor,ns), intent(out)&#160;</td>
          <td class="paramname"><em>fsupvmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jcurrumn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jcurrvmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize expected currents. </p>
<p>Up to the vmec last closed flux surface, initialize with the VMEC currents. outside, initalize to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">Fsupsmn</td><td>Contravariant current in the s direction on the full grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Fsupumn</td><td>Contravariant current in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Fsupvmn</td><td>Contravariant current in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jcurrumn</td><td>Contravariant VMEC current in the u direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jcurrvmn</td><td>Contravariant VMEC current in the v direction on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity of the residuals. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a94e06d110f4fab7bfe69ead5a415571b" name="a94e06d110f4fab7bfe69ead5a415571b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94e06d110f4fab7bfe69ead5a415571b">&#9670;&#160;</a></span>matvec_par_pchelms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::matvec_par_pchelms </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(nloc), intent(in)&#160;</td>
          <td class="paramname"><em>ploc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nloc), intent(out)&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parallel callback function for MatVec GMRES routine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ploc</td><td>Local displacement parameters. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Ap</td><td>Local Matrix element. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nloc</td><td>Local number of dimensiona. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac0114f3b63cccd456307e00fd6a5d21b" name="ac0114f3b63cccd456307e00fd6a5d21b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0114f3b63cccd456307e00fd6a5d21b">&#9670;&#160;</a></span>matvec_pchelms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pchelms::matvec_pchelms </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(ndim), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(ndim), intent(out)&#160;</td>
          <td class="paramname"><em>ap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serial callback function for MatVec GMRES routine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Displacement parameters. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Ap</td><td>Matrix element. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndim</td><td>Number of dimensiona. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacepchelms.html">pchelms</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
