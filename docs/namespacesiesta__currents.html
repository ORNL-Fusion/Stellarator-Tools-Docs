<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: siesta_currents Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacesiesta__currents.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">siesta_currents Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Takes the Curl(B) to return the contravariant current density. Contravariant components of the magnetic field must be converted to covariant components first.  
<a href="namespacesiesta__currents.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a1861d02b50c144fb6ba957bacbc6717b" id="r_a1861d02b50c144fb6ba957bacbc6717b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__currents.html#a1861d02b50c144fb6ba957bacbc6717b">cv_currents</a> (bsupsijh, bsupuijh, bsupvijh,</td></tr>
<tr class="memdesc:a1861d02b50c144fb6ba957bacbc6717b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute current density from Curl(B).  <br /></td></tr>
<tr class="separator:a1861d02b50c144fb6ba957bacbc6717b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72cc0d04e7475e53379e6a87d7e246d4" id="r_a72cc0d04e7475e53379e6a87d7e246d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__currents.html#a72cc0d04e7475e53379e6a87d7e246d4">curlb</a> (ksupsmnf, ksupumnf, ksupvmnf,</td></tr>
<tr class="memdesc:a72cc0d04e7475e53379e6a87d7e246d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute fourier components of contravariant currents on full radial grid.  <br /></td></tr>
<tr class="separator:a72cc0d04e7475e53379e6a87d7e246d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16290445ab1661aa846b1ad873c4c7d6" id="r_a16290445ab1661aa846b1ad873c4c7d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__currents.html#a16290445ab1661aa846b1ad873c4c7d6">getcv</a> (ksupsmnf, ksupumnf, ksupvmnf,</td></tr>
<tr class="memdesc:a16290445ab1661aa846b1ad873c4c7d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform full grid contravariant currents to real space.  <br /></td></tr>
<tr class="separator:a16290445ab1661aa846b1ad873c4c7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Takes the Curl(B) to return the contravariant current density. Contravariant components of the magnetic field must be converted to covariant components first. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a72cc0d04e7475e53379e6a87d7e246d4" name="a72cc0d04e7475e53379e6a87d7e246d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72cc0d04e7475e53379e6a87d7e246d4">&#9670;&#160;</a></span>curlb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_currents::curlb </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksupsmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksupumnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ksupvmnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute fourier components of contravariant currents on full radial grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupsmnf</td><td>Contravarant s component of the current with jacobian. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupumnf</td><td>Contravarant u component of the current with jacobian. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupvmnf</td><td>Contravarant v component of the current with jacobian. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsubsijh</td><td>Covariant s component of the magnetic field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsubuijh</td><td>Covariant u component of the magnetic field. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bsubvijh</td><td>Covariant v component of the magnetic field. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bs_filter</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bu_filter</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bv_filter</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">edge_cur</td><td>Edge current. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jsju_ratio</td><td>Ratio of &lt;K^s + r12*K^u&gt;/&lt;K^s - r12*K^u&gt;. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iparity</td><td>Parity flag for the fouier components. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lcurr</td><td>UNKNOWN </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">curtor</td><td>Current enclosed at the boundary. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1861d02b50c144fb6ba957bacbc6717b" name="a1861d02b50c144fb6ba957bacbc6717b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1861d02b50c144fb6ba957bacbc6717b">&#9670;&#160;</a></span>cv_currents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_currents::cv_currents </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bsupsijh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bsupuijh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bsupvijh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute current density from Curl(B). </p>
<p>Current density K is defined as</p>
<p>K = Curl(B)/mu0 (1)</p>
<p>In curvilinear coordinates this becomes</p>
<p>K^s = 1/sqrt(g)(dB_v/du - dB_u/dv) (2a)</p>
<p>K^u = 1/sqrt(g)(dB_s/dv - dB_v/ds) (2b)</p>
<p>K^v = 1/sqrt(g)(dB_u/ds - dB_s/du) (2c)</p>
<p>where sqrt(g) is the coordinate system Jacobian. Since there are derivatives with respect to s, these routines take the half grid values as input. The contravariant current computed will be on the full grid. These routines also output currents in real space. Note the computed Kmn are [sqrt(g)*K]mn with the embedded jacobian factor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupsijh</td><td>B^s on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupuijh</td><td>B^u on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupvijh</td><td>B^v on the half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupsijf</td><td>K^s on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupuijf</td><td>K^u on the full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupvijf</td><td>K^v on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lmagen</td><td>Logical controlling calc of magnetic energy wb. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lcurr</td><td>UNKNOWN </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a16290445ab1661aa846b1ad873c4c7d6" name="a16290445ab1661aa846b1ad873c4c7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16290445ab1661aa846b1ad873c4c7d6">&#9670;&#160;</a></span>getcv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_currents::getcv </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>ksupsmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>ksupumnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>ksupvmnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transform full grid contravariant currents to real space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ksupsmnf</td><td>Contravariant fourier current in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksupumnf</td><td>Contravariant fourier current in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksupvmnf</td><td>Contravariant fourier current in the v direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupsmnf</td><td>Contravariant real space current in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupumnf</td><td>Contravariant real space current in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksupvmnf</td><td>Contravariant real space current in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Partity flag fourier components. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesiesta__currents.html">siesta_currents</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
