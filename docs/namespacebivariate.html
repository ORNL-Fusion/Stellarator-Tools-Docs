<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: bivariate Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacebivariate.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">bivariate Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This modules contains routines for interpolating points inside a grid. This was originally written by S. P. Hirshman. It has been modified for thread safety converting it to be object oriented by M. Cianciosa.  
<a href="namespacebivariate.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An object containing persistent data for the bivariate interpolation.  <a href="structbivariate_1_1bivariate__class.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5f86038c03b5d3c99b7f2d87a2c709bb" id="r_a5f86038c03b5d3c99b7f2d87a2c709bb"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebivariate.html#a5f86038c03b5d3c99b7f2d87a2c709bb">bivariate_construct</a> (ns, nu)</td></tr>
<tr class="memdesc:a5f86038c03b5d3c99b7f2d87a2c709bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a bivariate_type object.  <br /></td></tr>
<tr class="separator:a5f86038c03b5d3c99b7f2d87a2c709bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac365c981828b3c0a9344226807d341f3" id="r_ac365c981828b3c0a9344226807d341f3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebivariate.html#ac365c981828b3c0a9344226807d341f3">bivariate_destruct</a> (this)</td></tr>
<tr class="memdesc:ac365c981828b3c0a9344226807d341f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deconstruct a bivariate_type object.  <br /></td></tr>
<tr class="separator:ac365c981828b3c0a9344226807d341f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb46db05deed3d3d4a4c78ca72ccca6e" id="r_aeb46db05deed3d3d4a4c78ca72ccca6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebivariate.html#aeb46db05deed3d3d4a4c78ca72ccca6e">bivariate_set_grids_2d</a> (this, rsu, zsu, rgrid, zgrid)</td></tr>
<tr class="memdesc:aeb46db05deed3d3d4a4c78ca72ccca6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the interpolation grid for a phi plane.  <br /></td></tr>
<tr class="separator:aeb46db05deed3d3d4a4c78ca72ccca6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbbf8d4b61b5ab496b658d804223947e" id="r_adbbf8d4b61b5ab496b658d804223947e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebivariate.html#adbbf8d4b61b5ab496b658d804223947e">bivariate_set_grids_1d</a> (this, rsu, zsu, rgrid, zgrid)</td></tr>
<tr class="memdesc:adbbf8d4b61b5ab496b658d804223947e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the interpolation grid for a phi plane.  <br /></td></tr>
<tr class="separator:adbbf8d4b61b5ab496b658d804223947e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eacc53209204cd912a2a898025863b6" id="r_a2eacc53209204cd912a2a898025863b6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebivariate.html#a2eacc53209204cd912a2a898025863b6">bivariate_get_4pt</a> (this, resp_rz, resp_su)</td></tr>
<tr class="memdesc:a2eacc53209204cd912a2a898025863b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate points on to response function grid.  <br /></td></tr>
<tr class="separator:a2eacc53209204cd912a2a898025863b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This modules contains routines for interpolating points inside a grid. This was originally written by S. P. Hirshman. It has been modified for thread safety converting it to be object oriented by M. Cianciosa. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a5f86038c03b5d3c99b7f2d87a2c709bb" name="a5f86038c03b5d3c99b7f2d87a2c709bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f86038c03b5d3c99b7f2d87a2c709bb">&#9670;&#160;</a></span>bivariate_construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class (<a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a>) function, pointer bivariate::bivariate_construct </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a bivariate_type object. </p>
<p>Allocates memory and initializes a bivariate_type object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>Number of radial grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of poloidal grid points. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a constructed bivariate_type object. </dd></dl>

</div>
</div>
<a id="ac365c981828b3c0a9344226807d341f3" name="ac365c981828b3c0a9344226807d341f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac365c981828b3c0a9344226807d341f3">&#9670;&#160;</a></span>bivariate_destruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bivariate::bivariate_destruct </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deconstruct a bivariate_type object. </p>
<p>Deallocates memory and uninitializes a bivariate_type object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A bivariate_type instance. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2eacc53209204cd912a2a898025863b6" name="a2eacc53209204cd912a2a898025863b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eacc53209204cd912a2a898025863b6">&#9670;&#160;</a></span>bivariate_get_4pt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bivariate::bivariate_get_4pt </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(this%nrz), intent(in)&#160;</td>
          <td class="paramname"><em>resp_rz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(this%nsu), intent(out)&#160;</td>
          <td class="paramname"><em>resp_su</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolate points on to response function grid. </p>
<p>Determin response function on the s,u grid by 4 point bivariate interpolation of response function on the r,z mesh at a fixed toroidal plane. This uses a 2-D interpolation based on the four point formula in Abramowitz and Stegun, Eq. 25.2.66. Note that the arrays need an explicit size in dimension to allow the 2D arrays to be passed to the 1D arguments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A bivariate_type instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resp_rz</td><td>Response function on the rz grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">resp_su</td><td>Response function on the su grid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adbbf8d4b61b5ab496b658d804223947e" name="adbbf8d4b61b5ab496b658d804223947e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbbf8d4b61b5ab496b658d804223947e">&#9670;&#160;</a></span>bivariate_set_grids_1d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bivariate::bivariate_set_grids_1d </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>rsu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>zsu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>rgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>zgrid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up the interpolation grid for a phi plane. </p>
<p>Compute the indices (ir_bi, jz_bi) and weight factors (wij_bi) for performing bivariate (4 pt) interpolation FROM a rectangular (R X Z) grid TO a general (non-orthogonal) grid (s, u). R and Z grids may have different mesh sizes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A bivariate_type instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rsu</td><td>r coordinate at s,u </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zsu</td><td>z coordinate at s,u </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rgrid</td><td>R coordinate on a fixed, equally spaced grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zgrid</td><td>Z coordinate on a fixed, equally spaced grid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeb46db05deed3d3d4a4c78ca72ccca6e" name="aeb46db05deed3d3d4a4c78ca72ccca6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb46db05deed3d3d4a4c78ca72ccca6e">&#9670;&#160;</a></span>bivariate_set_grids_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bivariate::bivariate_set_grids_2d </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structbivariate_1_1bivariate__class.html">bivariate_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rsu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>zsu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>rgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>zgrid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up the interpolation grid for a phi plane. </p>
<p>Compute the indices (ir_bi, jz_bi) and weight factors (wij_bi) for performing bivariate (4 pt) interpolation FROM a rectangular (R X Z) grid TO a general (non-orthogonal) grid (s, u). R and Z grids may have different mesh sizes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A bivariate_type instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rsu</td><td>r coordinate at s,u </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zsu</td><td>z coordinate at s,u </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rgrid</td><td>R coordinate on a fixed, equally spaced grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zgrid</td><td>Z coordinate on a fixed, equally spaced grid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacebivariate.html">bivariate</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
