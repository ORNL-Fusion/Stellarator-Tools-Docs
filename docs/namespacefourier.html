<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: fourier Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacefourier.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fourier Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Module contains subroutines for computing FFT on parallel radial intervals. Converts quantities between real and fourier space. Note fixarray must be called once before call any of the Fourier subroutines to calculate all necessary sine and cosine factors on a fixed mesh of collocation angles.  
<a href="namespacefourier.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class containing fourier memory.  <a href="structfourier_1_1fourier__class.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ae8eaa592cc2946be1c464738f6d41b59" id="r_ae8eaa592cc2946be1c464738f6d41b59"><td class="memItemLeft" align="right" valign="top">class(<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>) function, pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#ae8eaa592cc2946be1c464738f6d41b59">fourier_construct</a> (mpol, ntor, ntheta, nzeta, nfp, sym, tor_modes)</td></tr>
<tr class="memdesc:ae8eaa592cc2946be1c464738f6d41b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> object.  <br /></td></tr>
<tr class="separator:ae8eaa592cc2946be1c464738f6d41b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c0f441cadb0006a1d10031283535a8" id="r_a35c0f441cadb0006a1d10031283535a8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a35c0f441cadb0006a1d10031283535a8">fourier_destruct</a> (this)</td></tr>
<tr class="memdesc:a35c0f441cadb0006a1d10031283535a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deconstruct a <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> object.  <br /></td></tr>
<tr class="separator:a35c0f441cadb0006a1d10031283535a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac68c96514704e40ab8b27470b4cf21" id="r_a5ac68c96514704e40ab8b27470b4cf21"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a5ac68c96514704e40ab8b27470b4cf21">fourier_tomnsp_3d</a> (this, xuv, xmn, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a5ac68c96514704e40ab8b27470b4cf21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a quantity from real to fourier space in parallel.  <br /></td></tr>
<tr class="separator:a5ac68c96514704e40ab8b27470b4cf21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a500f54a6328d5c7e34a891871425e8db" id="r_a500f54a6328d5c7e34a891871425e8db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a500f54a6328d5c7e34a891871425e8db">fourier_tomnsp_3d_pest</a> (this, xuv, xmn, lmns, lmnc,</td></tr>
<tr class="memdesc:a500f54a6328d5c7e34a891871425e8db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a quantity from real to fourier space in pest coordinates.  <br /></td></tr>
<tr class="separator:a500f54a6328d5c7e34a891871425e8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1624922e688e9d0d4dc3817e96dd75ae" id="r_a1624922e688e9d0d4dc3817e96dd75ae"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a1624922e688e9d0d4dc3817e96dd75ae">fourier_tomnsp_2d</a> (this, xuv, xmn, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a1624922e688e9d0d4dc3817e96dd75ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fourier transform a 2D quantity to fourier space.  <br /></td></tr>
<tr class="separator:a1624922e688e9d0d4dc3817e96dd75ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af669d2453ff1041cfbcccae55bad9f7b" id="r_af669d2453ff1041cfbcccae55bad9f7b"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#af669d2453ff1041cfbcccae55bad9f7b">fourier_tomnsp_2d_pest</a> (this, xuv, xmn, lambda, dup</td></tr>
<tr class="memdesc:af669d2453ff1041cfbcccae55bad9f7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fourier transform a 2D quantity to fourier space.  <br /></td></tr>
<tr class="separator:af669d2453ff1041cfbcccae55bad9f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac8a2289d22906b1e06baed62d550af" id="r_acac8a2289d22906b1e06baed62d550af"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#acac8a2289d22906b1e06baed62d550af">fourier_tomnsp_2d_u</a> (this, xuv)</td></tr>
<tr class="memdesc:acac8a2289d22906b1e06baed62d550af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sum over the poloidal part.  <br /></td></tr>
<tr class="separator:acac8a2289d22906b1e06baed62d550af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb9afaad547575a84000f0b4d2e8e9c" id="r_a9cb9afaad547575a84000f0b4d2e8e9c"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a9cb9afaad547575a84000f0b4d2e8e9c">fourier_tomnsp_2d_u_pest</a> (this, xuv, lambda, dupdu,</td></tr>
<tr class="memdesc:a9cb9afaad547575a84000f0b4d2e8e9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sum over the poloidal part.  <br /></td></tr>
<tr class="separator:a9cb9afaad547575a84000f0b4d2e8e9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cab14517df7e98ba1340143b44acb6f" id="r_a9cab14517df7e98ba1340143b44acb6f"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a9cab14517df7e98ba1340143b44acb6f">fourier_tomnsp_2d_v</a> (this, xmn, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a9cab14517df7e98ba1340143b44acb6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sum over toroidal angle.  <br /></td></tr>
<tr class="separator:a9cab14517df7e98ba1340143b44acb6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077b192acbab552a945f1382c85ca9fc" id="r_a077b192acbab552a945f1382c85ca9fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a077b192acbab552a945f1382c85ca9fc">fourier_toijsp_3d</a> (this, xmn, xuv, dflag, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a077b192acbab552a945f1382c85ca9fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a quantity from fourier to real space in parallel.  <br /></td></tr>
<tr class="separator:a077b192acbab552a945f1382c85ca9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f5162fff4e2bd12c4a1130eb4aac3e" id="r_a27f5162fff4e2bd12c4a1130eb4aac3e"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a27f5162fff4e2bd12c4a1130eb4aac3e">fourier_toijsp_2d</a> (this, xmn, xuv, dflag, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a27f5162fff4e2bd12c4a1130eb4aac3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fourier transform a 2D quantity to real space.  <br /></td></tr>
<tr class="separator:a27f5162fff4e2bd12c4a1130eb4aac3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88798b860cb38f460b0e167de3de12b" id="r_af88798b860cb38f460b0e167de3de12b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#af88798b860cb38f460b0e167de3de12b">fourier_get_origin</a> (this, xuv, mode, asym)</td></tr>
<tr class="memdesc:af88798b860cb38f460b0e167de3de12b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the origin value of a half-mesh quantity.  <br /></td></tr>
<tr class="separator:af88798b860cb38f460b0e167de3de12b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed046e4607a3671eb9be0c2ef2a375eb" id="r_aed046e4607a3671eb9be0c2ef2a375eb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#aed046e4607a3671eb9be0c2ef2a375eb">fourier_round_trig</a> (cosi, sini)</td></tr>
<tr class="memdesc:aed046e4607a3671eb9be0c2ef2a375eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Round trig values to whole number for near numbers.  <br /></td></tr>
<tr class="separator:aed046e4607a3671eb9be0c2ef2a375eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab15e4ffa2fcfa91b1b7372684bbfc30a" id="r_ab15e4ffa2fcfa91b1b7372684bbfc30a"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#ab15e4ffa2fcfa91b1b7372684bbfc30a">fourier_get_index</a> (this, n)</td></tr>
<tr class="memdesc:ab15e4ffa2fcfa91b1b7372684bbfc30a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The the index position of the toroidal mode if it exists.  <br /></td></tr>
<tr class="separator:ab15e4ffa2fcfa91b1b7372684bbfc30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4331822c74c9060f004e2cc2186a058f" id="r_a4331822c74c9060f004e2cc2186a058f"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefourier.html#a4331822c74c9060f004e2cc2186a058f">test_fourier</a> ()</td></tr>
<tr class="memdesc:a4331822c74c9060f004e2cc2186a058f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test fourier routines.  <br /></td></tr>
<tr class="separator:a4331822c74c9060f004e2cc2186a058f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a41e6c5528ec17d73f36345622667c8ae" id="r_a41e6c5528ec17d73f36345622667c8ae"><td class="memItemLeft" align="right" valign="top"><a id="a41e6c5528ec17d73f36345622667c8ae" name="a41e6c5528ec17d73f36345622667c8ae"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_cos</b> = 0</td></tr>
<tr class="memdesc:a41e6c5528ec17d73f36345622667c8ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cosine parity. <br /></td></tr>
<tr class="separator:a41e6c5528ec17d73f36345622667c8ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d54d71b6f5a2a4ca9816d41b15136c" id="r_ae4d54d71b6f5a2a4ca9816d41b15136c"><td class="memItemLeft" align="right" valign="top"><a id="ae4d54d71b6f5a2a4ca9816d41b15136c" name="ae4d54d71b6f5a2a4ca9816d41b15136c"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_sin</b> = 1</td></tr>
<tr class="memdesc:ae4d54d71b6f5a2a4ca9816d41b15136c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sine parity. <br /></td></tr>
<tr class="separator:ae4d54d71b6f5a2a4ca9816d41b15136c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef77174c15ce7415c96e6098a2b77156" id="r_aef77174c15ce7415c96e6098a2b77156"><td class="memItemLeft" align="right" valign="top"><a id="aef77174c15ce7415c96e6098a2b77156" name="aef77174c15ce7415c96e6098a2b77156"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_none</b> = 0</td></tr>
<tr class="memdesc:aef77174c15ce7415c96e6098a2b77156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do not sum fouier real space transformed quantity. This is used when a stellarator symmetric parity is being converted to real space. <br /></td></tr>
<tr class="separator:aef77174c15ce7415c96e6098a2b77156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac353df5825590202d5c7a2de3688e5f0" id="r_ac353df5825590202d5c7a2de3688e5f0"><td class="memItemLeft" align="right" valign="top"><a id="ac353df5825590202d5c7a2de3688e5f0" name="ac353df5825590202d5c7a2de3688e5f0"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_ds</b> = 1</td></tr>
<tr class="memdesc:ac353df5825590202d5c7a2de3688e5f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Radial derivative flag. <br /></td></tr>
<tr class="separator:ac353df5825590202d5c7a2de3688e5f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60bc38ec9f367c4b73bc5badbcc3d0a7" id="r_a60bc38ec9f367c4b73bc5badbcc3d0a7"><td class="memItemLeft" align="right" valign="top"><a id="a60bc38ec9f367c4b73bc5badbcc3d0a7" name="a60bc38ec9f367c4b73bc5badbcc3d0a7"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_du</b> = 2</td></tr>
<tr class="memdesc:a60bc38ec9f367c4b73bc5badbcc3d0a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poloidal derivative flag. <br /></td></tr>
<tr class="separator:a60bc38ec9f367c4b73bc5badbcc3d0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed197cd20f5735b408f831cf2f9b3799" id="r_aed197cd20f5735b408f831cf2f9b3799"><td class="memItemLeft" align="right" valign="top"><a id="aed197cd20f5735b408f831cf2f9b3799" name="aed197cd20f5735b408f831cf2f9b3799"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_dv</b> = 4</td></tr>
<tr class="memdesc:aed197cd20f5735b408f831cf2f9b3799"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toroidal derivative flag. <br /></td></tr>
<tr class="separator:aed197cd20f5735b408f831cf2f9b3799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380aa7707832d4030eccb0830068948d" id="r_a380aa7707832d4030eccb0830068948d"><td class="memItemLeft" align="right" valign="top"><a id="a380aa7707832d4030eccb0830068948d" name="a380aa7707832d4030eccb0830068948d"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_dudv</b> = IOR(<a class="el" href="namespacefourier.html#a60bc38ec9f367c4b73bc5badbcc3d0a7">f_du</a>, <a class="el" href="namespacefourier.html#aed197cd20f5735b408f831cf2f9b3799">f_dv</a>)</td></tr>
<tr class="memdesc:a380aa7707832d4030eccb0830068948d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combined toroidal and poloidal derivatives. <br /></td></tr>
<tr class="separator:a380aa7707832d4030eccb0830068948d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35531eaf8acef68309d9ac9470dda0bc" id="r_a35531eaf8acef68309d9ac9470dda0bc"><td class="memItemLeft" align="right" valign="top"><a id="a35531eaf8acef68309d9ac9470dda0bc" name="a35531eaf8acef68309d9ac9470dda0bc"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_sum</b> = 8</td></tr>
<tr class="memdesc:a35531eaf8acef68309d9ac9470dda0bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sum fouier real space transformed quantity. This is used when a non-stellarator symmetric parity is being converted to real space. <br /></td></tr>
<tr class="separator:a35531eaf8acef68309d9ac9470dda0bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa7de072427fc6454e37458d7680f172" id="r_afa7de072427fc6454e37458d7680f172"><td class="memItemLeft" align="right" valign="top"><a id="afa7de072427fc6454e37458d7680f172" name="afa7de072427fc6454e37458d7680f172"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_jac</b> = 16</td></tr>
<tr class="memdesc:afa7de072427fc6454e37458d7680f172"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quantity, contains jacobian. <br /></td></tr>
<tr class="separator:afa7de072427fc6454e37458d7680f172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0023db38a18486c4716f09578cb71b8" id="r_ae0023db38a18486c4716f09578cb71b8"><td class="memItemLeft" align="right" valign="top"><a id="ae0023db38a18486c4716f09578cb71b8" name="ae0023db38a18486c4716f09578cb71b8"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>f_con</b> = 32</td></tr>
<tr class="memdesc:ae0023db38a18486c4716f09578cb71b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covariant basis. <br /></td></tr>
<tr class="separator:ae0023db38a18486c4716f09578cb71b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae25c012d089b70bc7f4c1a8bad0e7b82" id="r_ae25c012d089b70bc7f4c1a8bad0e7b82"><td class="memItemLeft" align="right" valign="top"><a id="ae25c012d089b70bc7f4c1a8bad0e7b82" name="ae25c012d089b70bc7f4c1a8bad0e7b82"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>b_ds</b> = 0</td></tr>
<tr class="memdesc:ae25c012d089b70bc7f4c1a8bad0e7b82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit position of the <a class="el" href="namespacefourier.html#ac353df5825590202d5c7a2de3688e5f0">f_ds</a> flag. <br /></td></tr>
<tr class="separator:ae25c012d089b70bc7f4c1a8bad0e7b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b777ae0dba1e815ae50603e7af866f8" id="r_a6b777ae0dba1e815ae50603e7af866f8"><td class="memItemLeft" align="right" valign="top"><a id="a6b777ae0dba1e815ae50603e7af866f8" name="a6b777ae0dba1e815ae50603e7af866f8"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>b_du</b> = 1</td></tr>
<tr class="memdesc:a6b777ae0dba1e815ae50603e7af866f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit position of the <a class="el" href="namespacefourier.html#a60bc38ec9f367c4b73bc5badbcc3d0a7">f_du</a> flag. <br /></td></tr>
<tr class="separator:a6b777ae0dba1e815ae50603e7af866f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fd44450246a6feb4a9530f61656e806" id="r_a7fd44450246a6feb4a9530f61656e806"><td class="memItemLeft" align="right" valign="top"><a id="a7fd44450246a6feb4a9530f61656e806" name="a7fd44450246a6feb4a9530f61656e806"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>b_dv</b> = 2</td></tr>
<tr class="memdesc:a7fd44450246a6feb4a9530f61656e806"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit position of the <a class="el" href="namespacefourier.html#aed197cd20f5735b408f831cf2f9b3799">f_dv</a> flag. <br /></td></tr>
<tr class="separator:a7fd44450246a6feb4a9530f61656e806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9ca0e5c35ee8c667fa98817c2f48f8" id="r_a9e9ca0e5c35ee8c667fa98817c2f48f8"><td class="memItemLeft" align="right" valign="top"><a id="a9e9ca0e5c35ee8c667fa98817c2f48f8" name="a9e9ca0e5c35ee8c667fa98817c2f48f8"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>b_sum</b> = 3</td></tr>
<tr class="memdesc:a9e9ca0e5c35ee8c667fa98817c2f48f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit position of the <a class="el" href="namespacefourier.html#a35531eaf8acef68309d9ac9470dda0bc">f_sum</a> flag. <br /></td></tr>
<tr class="separator:a9e9ca0e5c35ee8c667fa98817c2f48f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a316da76b114c9060804aff5499b981a5" id="r_a316da76b114c9060804aff5499b981a5"><td class="memItemLeft" align="right" valign="top"><a id="a316da76b114c9060804aff5499b981a5" name="a316da76b114c9060804aff5499b981a5"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>b_jac</b> = 4</td></tr>
<tr class="memdesc:a316da76b114c9060804aff5499b981a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit position of the <a class="el" href="namespacefourier.html#afa7de072427fc6454e37458d7680f172">f_jac</a> flag. <br /></td></tr>
<tr class="separator:a316da76b114c9060804aff5499b981a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd52935e53db15768136ead24a1c673" id="r_a4bd52935e53db15768136ead24a1c673"><td class="memItemLeft" align="right" valign="top"><a id="a4bd52935e53db15768136ead24a1c673" name="a4bd52935e53db15768136ead24a1c673"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>b_con</b> = 5</td></tr>
<tr class="memdesc:a4bd52935e53db15768136ead24a1c673"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit position of the <a class="el" href="namespacefourier.html#a4bd52935e53db15768136ead24a1c673">b_con</a> flag. <br /></td></tr>
<tr class="separator:a4bd52935e53db15768136ead24a1c673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5dae82f1576d7a954417488841c81b4" id="r_ab5dae82f1576d7a954417488841c81b4"><td class="memItemLeft" align="right" valign="top"><a id="ab5dae82f1576d7a954417488841c81b4" name="ab5dae82f1576d7a954417488841c81b4"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>m0</b> = 0</td></tr>
<tr class="memdesc:ab5dae82f1576d7a954417488841c81b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">m = 0 mode. <br /></td></tr>
<tr class="separator:ab5dae82f1576d7a954417488841c81b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7378da676474b8d8356fafd8176f194" id="r_ac7378da676474b8d8356fafd8176f194"><td class="memItemLeft" align="right" valign="top"><a id="ac7378da676474b8d8356fafd8176f194" name="ac7378da676474b8d8356fafd8176f194"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>m1</b> = 1</td></tr>
<tr class="memdesc:ac7378da676474b8d8356fafd8176f194"><td class="mdescLeft">&#160;</td><td class="mdescRight">m = 1 mode. <br /></td></tr>
<tr class="separator:ac7378da676474b8d8356fafd8176f194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a590891f5c6ddc4bb6849e9f3814d65" id="r_a3a590891f5c6ddc4bb6849e9f3814d65"><td class="memItemLeft" align="right" valign="top"><a id="a3a590891f5c6ddc4bb6849e9f3814d65" name="a3a590891f5c6ddc4bb6849e9f3814d65"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>m2</b> = 2</td></tr>
<tr class="memdesc:a3a590891f5c6ddc4bb6849e9f3814d65"><td class="mdescLeft">&#160;</td><td class="mdescRight">m = 2 mode. <br /></td></tr>
<tr class="separator:a3a590891f5c6ddc4bb6849e9f3814d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dcc2c6b7198cc965d4873adc6611102" id="r_a2dcc2c6b7198cc965d4873adc6611102"><td class="memItemLeft" align="right" valign="top"><a id="a2dcc2c6b7198cc965d4873adc6611102" name="a2dcc2c6b7198cc965d4873adc6611102"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>n0</b> = 0</td></tr>
<tr class="memdesc:a2dcc2c6b7198cc965d4873adc6611102"><td class="mdescLeft">&#160;</td><td class="mdescRight">n = 0 mode. <br /></td></tr>
<tr class="separator:a2dcc2c6b7198cc965d4873adc6611102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad32b3261fca9f0284a553b832862c85d" id="r_ad32b3261fca9f0284a553b832862c85d"><td class="memItemLeft" align="right" valign="top"><a id="ad32b3261fca9f0284a553b832862c85d" name="ad32b3261fca9f0284a553b832862c85d"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><b>n1</b> = 1</td></tr>
<tr class="memdesc:ad32b3261fca9f0284a553b832862c85d"><td class="mdescLeft">&#160;</td><td class="mdescRight">n = 1 mode. <br /></td></tr>
<tr class="separator:ad32b3261fca9f0284a553b832862c85d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module contains subroutines for computing FFT on parallel radial intervals. Converts quantities between real and fourier space. Note fixarray must be called once before call any of the Fourier subroutines to calculate all necessary sine and cosine factors on a fixed mesh of collocation angles. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae8eaa592cc2946be1c464738f6d41b59" name="ae8eaa592cc2946be1c464738f6d41b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8eaa592cc2946be1c464738f6d41b59">&#9670;&#160;</a></span>fourier_construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>) function, pointer fourier::fourier_construct </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mpol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nzeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(-ntor:ntor), intent(in)&#160;</td>
          <td class="paramname"><em>tor_modes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> object. </p>
<p>Allocates memory and initializes a <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> object. Computes the othronorm and cosine and sine buffers.</p>
<p>This subroutine computes the cosine-sine factors that will be needed when moving between Fourier and real space. All normalizations are contained in the poloidal quantities used in the Fourier to real space transformation:</p><ul>
<li>sinmui</li>
<li>cosmui</li>
</ul>
<p>Fourier representations are assumed to have stellarator symmetry: *# cosine (iparity=0): C(u, v) = sum_u sum_v (C_mn COS(mu + n*nfp*v)) *# sine (iparity=1): S(u, v) = sum_u sum_v (S_mn SIN(mu + n*nfp*v))</p>
<p>The number of collocation points have been set initalially equal to the number of modes: theta_j = j*pi/M, j = 0,...,M Where M = mpol - 1 zeta_k = k*2*pi/(2N + 1) k = 0,...,2N Where N = ntor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mpol</td><td>Number of poloidal modes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntor</td><td>Number of toroidal modes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntheta</td><td>Number of poloidal real grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nzeta</td><td>Number of toroidal real grid points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nfp</td><td>Number of field periods. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sym</td><td>Symmetry flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tor_modes</td><td>Toroidal mode numbers. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a35c0f441cadb0006a1d10031283535a8" name="a35c0f441cadb0006a1d10031283535a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c0f441cadb0006a1d10031283535a8">&#9670;&#160;</a></span>fourier_destruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fourier::fourier_destruct </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deconstruct a <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> object. </p>
<p>Deallocates memory and uninitializes a <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab15e4ffa2fcfa91b1b7372684bbfc30a" name="ab15e4ffa2fcfa91b1b7372684bbfc30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab15e4ffa2fcfa91b1b7372684bbfc30a">&#9670;&#160;</a></span>fourier_get_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function fourier::fourier_get_index </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The the index position of the toroidal mode if it exists. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Toroidal mode number to check the index on exit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the mode number was found. </dd></dl>

</div>
</div>
<a id="af88798b860cb38f460b0e167de3de12b" name="af88798b860cb38f460b0e167de3de12b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af88798b860cb38f460b0e167de3de12b">&#9670;&#160;</a></span>fourier_get_origin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fourier::fourier_get_origin </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>asym</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the origin value of a half-mesh quantity. </p>
<p>The origin quantity is found from the m mode of the js = 2 value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xuv</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>Poloidal mode number to be retained. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">asym</td><td>Add stellarator asymmetric terms. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aed046e4607a3671eb9be0c2ef2a375eb" name="aed046e4607a3671eb9be0c2ef2a375eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed046e4607a3671eb9be0c2ef2a375eb">&#9670;&#160;</a></span>fourier_round_trig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fourier::fourier_round_trig </td>
          <td>(</td>
          <td class="paramtype">real (dp), intent(inout)&#160;</td>
          <td class="paramname"><em>cosi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), intent(inout)&#160;</td>
          <td class="paramname"><em>sini</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Round trig values to whole number for near numbers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cosi</td><td>Cosine value to round. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sini</td><td>Sine value to round. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a27f5162fff4e2bd12c4a1130eb4aac3e" name="a27f5162fff4e2bd12c4a1130eb4aac3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27f5162fff4e2bd12c4a1130eb4aac3e">&#9670;&#160;</a></span>fourier_toijsp_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fourier::fourier_toijsp_2d </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fourier transform a 2D quantity to real space. </p>
<p>Works by reshaping to a 3D array then passing to the normal 3D version.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmn</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xuv</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dflag</td><td>Derivative and sum control flags. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a077b192acbab552a945f1382c85ca9fc" name="a077b192acbab552a945f1382c85ca9fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a077b192acbab552a945f1382c85ca9fc">&#9670;&#160;</a></span>fourier_toijsp_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fourier::fourier_toijsp_3d </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a quantity from fourier to real space in parallel. </p>
<p>This subroutine moves a quantity to real space by summing over its Fourier harmonics. If the <a class="el" href="namespacefourier.html#a60bc38ec9f367c4b73bc5badbcc3d0a7">f_du</a> flag is set take the poloidal derivative. If the <a class="el" href="namespacefourier.html#aed197cd20f5735b408f831cf2f9b3799">f_dv</a> flag is set take the toroidal derivative. If the f_sum flag is set add the real quanity to the previous value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmn</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xuv</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dflag</td><td>Derivative and sum control flags. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1624922e688e9d0d4dc3817e96dd75ae" name="a1624922e688e9d0d4dc3817e96dd75ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1624922e688e9d0d4dc3817e96dd75ae">&#9670;&#160;</a></span>fourier_tomnsp_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fourier::fourier_tomnsp_2d </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fourier transform a 2D quantity to fourier space. </p>
<p>Works by reshaping to a 3D array then passing to the normal 3D version. Have the 3D function call the 2D function for each slice.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xmn</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af669d2453ff1041cfbcccae55bad9f7b" name="af669d2453ff1041cfbcccae55bad9f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af669d2453ff1041cfbcccae55bad9f7b">&#9670;&#160;</a></span>fourier_tomnsp_2d_pest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fourier::fourier_tomnsp_2d_pest </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fourier transform a 2D quantity to fourier space. </p>
<p>Works by reshaping to a 3D array then passing to the normal 3D version. Have the 3D function call the 2D function for each slice.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xmn</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lambda</td><td>Stellarator symmetric lambda. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dupdu</td><td>Stellarator asymmetric lambda. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">asym</td><td>Add stellarator asymmetric terms. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acac8a2289d22906b1e06baed62d550af" name="acac8a2289d22906b1e06baed62d550af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac8a2289d22906b1e06baed62d550af">&#9670;&#160;</a></span>fourier_tomnsp_2d_u()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fourier::fourier_tomnsp_2d_u </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xuv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sum over the poloidal part. </p>
<p>Pest transforms use the same sum over v but different sums over u. To encourage code reuse break the u and v sums into separate methods. This version uses the regular poloidal sum.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Fourier space quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9cb9afaad547575a84000f0b4d2e8e9c" name="a9cb9afaad547575a84000f0b4d2e8e9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb9afaad547575a84000f0b4d2e8e9c">&#9670;&#160;</a></span>fourier_tomnsp_2d_u_pest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fourier::fourier_tomnsp_2d_u_pest </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>dupdu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sum over the poloidal part. </p>
<p>Pest transforms use the same sum over v but different sums over u. To encourage code reuse break the u and v sums into separate methods. This version uses the lambda poloidal sum.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lmns</td><td>Stellarator symmetric lambda. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lmnc</td><td>Stellarator asymmetric lambda. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">asym</td><td>Add stellarator asymmetric terms. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9cab14517df7e98ba1340143b44acb6f" name="a9cab14517df7e98ba1340143b44acb6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cab14517df7e98ba1340143b44acb6f">&#9670;&#160;</a></span>fourier_tomnsp_2d_v()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fourier::fourier_tomnsp_2d_v </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sum over toroidal angle. </p>
<p>Pest transforms use the same sum over v but different sums over u. To encourage code reuse break the u and v sums into separate methods. This impliments the common toroidal sum.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xmn</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5ac68c96514704e40ab8b27470b4cf21" name="a5ac68c96514704e40ab8b27470b4cf21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac68c96514704e40ab8b27470b4cf21">&#9670;&#160;</a></span>fourier_tomnsp_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fourier::fourier_tomnsp_3d </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a quantity from real to fourier space in parallel. </p>
<p>This subroutine moves a 3D quantity to fourier space by summing over its real represenetation for each surface. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacefourier.html#a1624922e688e9d0d4dc3817e96dd75ae" title="Fourier transform a 2D quantity to fourier space.">fourier_tomnsp_2d</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xmn</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a500f54a6328d5c7e34a891871425e8db" name="a500f54a6328d5c7e34a891871425e8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a500f54a6328d5c7e34a891871425e8db">&#9670;&#160;</a></span>fourier_tomnsp_3d_pest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fourier::fourier_tomnsp_3d_pest </td>
          <td>(</td>
          <td class="paramtype">class (<a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>xuv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>xmn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lmns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lmnc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a quantity from real to fourier space in pest coordinates. </p>
<p>This subroutine moves a 3D quantity to fourier space by summing over its real represenetation for each surface. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacefourier.html#af669d2453ff1041cfbcccae55bad9f7b" title="Fourier transform a 2D quantity to fourier space.">fourier_tomnsp_2d_pest</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">this</td><td>A <a class="el" href="structfourier_1_1fourier__class.html">fourier_class</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xuv</td><td>Real space quantity. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xmn</td><td>Fourier space quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lmns</td><td>Stellarator symmetric lambda. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lmnc</td><td>Stellarator asymmetric lambda. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fourier parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">asym</td><td>Add stellarator asymmetric terms. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4331822c74c9060f004e2cc2186a058f" name="a4331822c74c9060f004e2cc2186a058f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4331822c74c9060f004e2cc2186a058f">&#9670;&#160;</a></span>test_fourier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function fourier::test_fourier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test fourier routines. </p>
<p>This tests the routines by fourier transforming form flux to real space then back again. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefourier.html">fourier</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
