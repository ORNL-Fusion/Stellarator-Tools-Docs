<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: utilities Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceutilities.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">utilities Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file contains utilities for converting the siesta grids.  
<a href="namespaceutilities.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceutilities_1_1curl__htof.html">curl_htof</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to take the curl on a half mesh quantity and return a full mesh using either <a class="el" href="interfaceutilities_1_1curl__htof.html">curl_htof</a> or <a class="el" href="interfaceutilities_1_1curl__htof.html#a70004de9e4acdbf6dff1a0ead5d8bb54">curl_htof_targ</a>.  <a href="interfaceutilities_1_1curl__htof.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceutilities_1_1gradienthalf.html">gradienthalf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to take the gradianet from full to half mesh using either GradientHalf or GradientHalf_p.  <a href="interfaceutilities_1_1gradienthalf.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceutilities_1_1set__bndy__fouier__m0.html">set_bndy_fouier_m0</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to set the fouier conditions on a quantity for either scalar <a class="el" href="interfaceutilities_1_1set__bndy__fouier__m0.html">set_bndy_fouier_m0</a> or vector <a class="el" href="interfaceutilities_1_1set__bndy__fouier__m0.html#aa6053635f4d12e9d6be78a9089ca9470">set_bndy_fouier_m0_vec</a> quantities.  <a href="interfaceutilities_1_1set__bndy__fouier__m0.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceutilities_1_1to__full__mesh.html">to_full_mesh</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to convert between half and full mesh using either <a class="el" href="interfaceutilities_1_1to__full__mesh.html#a0c6757ea338f495f18375613bd2a6293">to_full_mesh2</a> or <a class="el" href="interfaceutilities_1_1to__full__mesh.html#ad18ac9c59de0be0ef44492ebe05a1ea7">to_full_mesh3</a>.  <a href="interfaceutilities_1_1to__full__mesh.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceutilities_1_1to__half__mesh.html">to_half_mesh</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to convert between full and half mesh using either <a class="el" href="interfaceutilities_1_1to__half__mesh.html">to_half_mesh</a> or <a class="el" href="interfaceutilities_1_1to__half__mesh.html#a17173a22873cc4031419a3f79fcb5abe">to_half_mesh_p</a>.  <a href="interfaceutilities_1_1to__half__mesh.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a01ba55178440836b2eeb8dc1ea00b222" id="r_a01ba55178440836b2eeb8dc1ea00b222"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a01ba55178440836b2eeb8dc1ea00b222">gradienthalf</a> (gradienth, vecf)</td></tr>
<tr class="memdesc:a01ba55178440836b2eeb8dc1ea00b222"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the gradient to the half mesh from a full mesh quantity.  <br /></td></tr>
<tr class="separator:a01ba55178440836b2eeb8dc1ea00b222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930e09a0285c4594d26ccc7489eca6c5" id="r_a930e09a0285c4594d26ccc7489eca6c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a930e09a0285c4594d26ccc7489eca6c5">gradienthalf_p</a> (gradienth, vecf)</td></tr>
<tr class="memdesc:a930e09a0285c4594d26ccc7489eca6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the gradient to the half mesh from a full mesh quantity.  <br /></td></tr>
<tr class="separator:a930e09a0285c4594d26ccc7489eca6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01bacb665908fabbf43dabb56cae2e20" id="r_a01bacb665908fabbf43dabb56cae2e20"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a01bacb665908fabbf43dabb56cae2e20">gradientfull</a> (gradientf, vech)</td></tr>
<tr class="memdesc:a01bacb665908fabbf43dabb56cae2e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the gradient to the full mesh from a half mesh quantity.  <br /></td></tr>
<tr class="separator:a01bacb665908fabbf43dabb56cae2e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa56fb8ab863c6128f936e34a3028c8f0" id="r_aa56fb8ab863c6128f936e34a3028c8f0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#aa56fb8ab863c6128f936e34a3028c8f0">to_half_mesh</a> (vecf, vech)</td></tr>
<tr class="memdesc:aa56fb8ab863c6128f936e34a3028c8f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrates a full mesh quantity to the half mesh.  <br /></td></tr>
<tr class="separator:aa56fb8ab863c6128f936e34a3028c8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a396f6885db6a18350a572b6df1b58195" id="r_a396f6885db6a18350a572b6df1b58195"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a396f6885db6a18350a572b6df1b58195">to_half_mesh_p</a> (vecf, vech)</td></tr>
<tr class="memdesc:a396f6885db6a18350a572b6df1b58195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrates a full mesh quantity to the half mesh.  <br /></td></tr>
<tr class="separator:a396f6885db6a18350a572b6df1b58195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa39bbeefd09bd82b946d1ac38e7856ae" id="r_aa39bbeefd09bd82b946d1ac38e7856ae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#aa39bbeefd09bd82b946d1ac38e7856ae">to_full_mesh3</a> (vech, vecf)</td></tr>
<tr class="memdesc:aa39bbeefd09bd82b946d1ac38e7856ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrate a three dimensional quantity form the half mesh to the full mesh.  <br /></td></tr>
<tr class="separator:aa39bbeefd09bd82b946d1ac38e7856ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001873e5aa19fce5d04482dde1e081bd" id="r_a001873e5aa19fce5d04482dde1e081bd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a001873e5aa19fce5d04482dde1e081bd">to_full_mesh2</a> (vech, vecf)</td></tr>
<tr class="memdesc:a001873e5aa19fce5d04482dde1e081bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrate a two dimensional quantity form the half mesh to the full mesh.  <br /></td></tr>
<tr class="separator:a001873e5aa19fce5d04482dde1e081bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020ef8a2392cbc73ff8f3ffdb0ec2b24" id="r_a020ef8a2392cbc73ff8f3ffdb0ec2b24"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a020ef8a2392cbc73ff8f3ffdb0ec2b24">curl_ftoh</a> (asubsmnf, asubumnf, asubvmnf,</td></tr>
<tr class="memdesc:a020ef8a2392cbc73ff8f3ffdb0ec2b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute curl of the full grid quantity a on the half grid.  <br /></td></tr>
<tr class="separator:a020ef8a2392cbc73ff8f3ffdb0ec2b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c9976c2bc582dc3d1eaa214623e4311" id="r_a4c9976c2bc582dc3d1eaa214623e4311"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a4c9976c2bc582dc3d1eaa214623e4311">curl_htof</a> (bsubsmnh, bsubumnh, bsubvmnh,</td></tr>
<tr class="memdesc:a4c9976c2bc582dc3d1eaa214623e4311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute curl of the half grid quantity a on the full grid.  <br /></td></tr>
<tr class="separator:a4c9976c2bc582dc3d1eaa214623e4311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd65733c2b544b3a4c4e593b8b45ff32" id="r_acd65733c2b544b3a4c4e593b8b45ff32"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#acd65733c2b544b3a4c4e593b8b45ff32">curl_htof_targ</a> (bsubsmnh, bsubumnh, bsubvmnh,</td></tr>
<tr class="memdesc:acd65733c2b544b3a4c4e593b8b45ff32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert allocatable to pointer for use in <a class="el" href="interfaceutilities_1_1curl__htof.html">curl_htof</a>.  <br /></td></tr>
<tr class="separator:acd65733c2b544b3a4c4e593b8b45ff32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f338cb8baf6e5037a88ab897404521" id="r_aa8f338cb8baf6e5037a88ab897404521"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#aa8f338cb8baf6e5037a88ab897404521">set_bndy_half_to_full</a> (amnh, amnf, nsmin, <a class="el" href="classparity.html">parity</a>, f</td></tr>
<tr class="memdesc:aa8f338cb8baf6e5037a88ab897404521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set fouier boundary conditions for full grid quantity converted from half grid.  <br /></td></tr>
<tr class="separator:aa8f338cb8baf6e5037a88ab897404521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e45cf4046669d9fabd21ebd8d16f1b" id="r_ad6e45cf4046669d9fabd21ebd8d16f1b"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#ad6e45cf4046669d9fabd21ebd8d16f1b">set_bndy_half_to_full_ds</a> (amnh, amnf_ds, nsmin, par</td></tr>
<tr class="memdesc:ad6e45cf4046669d9fabd21ebd8d16f1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set fouier boundary conditions for full grid radial derivative quantity converted from half grid.  <br /></td></tr>
<tr class="separator:ad6e45cf4046669d9fabd21ebd8d16f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb81c8bfa3087cdaad4c2617e4383df" id="r_aefb81c8bfa3087cdaad4c2617e4383df"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#aefb81c8bfa3087cdaad4c2617e4383df">set_bndy_full_origin</a> (amnsf, amnuf, amnvf, flags)</td></tr>
<tr class="memdesc:aefb81c8bfa3087cdaad4c2617e4383df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply origin vector boundary conditions.  <br /></td></tr>
<tr class="separator:aefb81c8bfa3087cdaad4c2617e4383df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e6a8da8f9874f6e6fcec023e6964c2f" id="r_a9e6a8da8f9874f6e6fcec023e6964c2f"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a9e6a8da8f9874f6e6fcec023e6964c2f">set_bndy_fouier_m0</a> (amn, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a9e6a8da8f9874f6e6fcec023e6964c2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set vector fourier conditions.  <br /></td></tr>
<tr class="separator:a9e6a8da8f9874f6e6fcec023e6964c2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a969bf9187692dd68e7b48a00f70f372d" id="r_a969bf9187692dd68e7b48a00f70f372d"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a969bf9187692dd68e7b48a00f70f372d">set_bndy_fouier_m0_vec</a> (amns, amnu, amnv, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a969bf9187692dd68e7b48a00f70f372d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set vector fourier conditions.  <br /></td></tr>
<tr class="separator:a969bf9187692dd68e7b48a00f70f372d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5673acaafc8662d0527dbe1b8a28b790" id="r_a5673acaafc8662d0527dbe1b8a28b790"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a5673acaafc8662d0527dbe1b8a28b790">div_h</a> (jbsupsmnh, jbsupumnh, jbsupvmnh,</td></tr>
<tr class="memdesc:a5673acaafc8662d0527dbe1b8a28b790"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the divergence of a half grid quantity.  <br /></td></tr>
<tr class="separator:a5673acaafc8662d0527dbe1b8a28b790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365a15cb83921febb9278a6a9b158079" id="r_a365a15cb83921febb9278a6a9b158079"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a365a15cb83921febb9278a6a9b158079">test_utilities</a> ()</td></tr>
<tr class="memdesc:a365a15cb83921febb9278a6a9b158079"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test utility routines.  <br /></td></tr>
<tr class="separator:a365a15cb83921febb9278a6a9b158079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3595a7fa86d5b7714483cc9cb05ff00f" id="r_a3595a7fa86d5b7714483cc9cb05ff00f"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceutilities.html#a3595a7fa86d5b7714483cc9cb05ff00f">test_div</a> (jbsupsmnh, jbsupumnh, jbsupvmnh, <a class="el" href="classparity.html">parity</a>, nsmin,</td></tr>
<tr class="memdesc:a3595a7fa86d5b7714483cc9cb05ff00f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test divergence of a half grid quantity.  <br /></td></tr>
<tr class="separator:a3595a7fa86d5b7714483cc9cb05ff00f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains utilities for converting the siesta grids. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a020ef8a2392cbc73ff8f3ffdb0ec2b24" name="a020ef8a2392cbc73ff8f3ffdb0ec2b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a020ef8a2392cbc73ff8f3ffdb0ec2b24">&#9670;&#160;</a></span>curl_ftoh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::curl_ftoh </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>asubsmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>asubumnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>asubvmnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute curl of the full grid quantity a on the half grid. </p>
<p>The contravariant components of jac*Curl A are equal to</p>
<p>sqrt(g)*B^k = dA_j/du^i - dA_i/du^j (j)</p>
<p>for cyclic permutations of i,j,k. This routine does not remove the jacobian factor. The arrays must be passed in as ALLOCATABLE or POINTER to preserve the array bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">asubsmnf</td><td>Covariant vector in the s direction full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">asubsmnf</td><td>Covariant vector in the u direction full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">asubsmnf</td><td>Covariant vector in the v direction full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbsubsmnh</td><td>Contravariant vector in the s direction with jacobian factor half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbsubsmnh</td><td>Contravariant vector in the u direction with jacobian factor half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbsubsmnh</td><td>Contravariant vector in the v direction with jacobian factor half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4c9976c2bc582dc3d1eaa214623e4311" name="a4c9976c2bc582dc3d1eaa214623e4311"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c9976c2bc582dc3d1eaa214623e4311">&#9670;&#160;</a></span>curl_htof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfaceutilities_1_1curl__htof.html">utilities::curl_htof</a> </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>bsubsmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>bsubumnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>bsubvmnh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute curl of the half grid quantity a on the full grid. </p>
<p>The contravariant components of jac*Curl A are equal to</p>
<p>sqrt(g)*K^k = dB_j/du^i - dB_i/du^j (j)</p>
<p>for cyclic permutations of i,j,k. This routine does not remove the jacobian factor. The arrays must be passed in as ALLOCATABLE or POINTER to preserve the array bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bsubsmnh</td><td>Covariant vector in the s direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsubsmnh</td><td>Covariant vector in the u direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsubsmnh</td><td>Covariant vector in the v direction half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jKsubsmnf</td><td>Contravariant vector in the s direction with jacobian factor full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jKsubsmnf</td><td>Contravariant vector in the u direction with jacobian factor full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jKsubsmnf</td><td>Contravariant vector in the v direction with jacobian factor full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsend</td><td>Ending row index. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">curtor</td><td>Current enclosed at the boundary. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acd65733c2b544b3a4c4e593b8b45ff32" name="acd65733c2b544b3a4c4e593b8b45ff32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd65733c2b544b3a4c4e593b8b45ff32">&#9670;&#160;</a></span>curl_htof_targ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::curl_htof_targ </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>bsubsmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>bsubumnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>bsubvmnh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert allocatable to pointer for use in <a class="el" href="interfaceutilities_1_1curl__htof.html">curl_htof</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Asubsmnh</td><td>Covariant vector in the s direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asubsmnh</td><td>Covariant vector in the u direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Asubsmnh</td><td>Covariant vector in the v direction half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jBsubsmnf</td><td>Contravariant vector in the s direction with jacobian factor full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jBsubsmnf</td><td>Contravariant vector in the u direction with jacobian factor full grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jBsubsmnf</td><td>Contravariant vector in the v direction with jacobian factor full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsend</td><td>Ending row index. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">curtor</td><td>Current enclosed at the boundary. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5673acaafc8662d0527dbe1b8a28b790" name="a5673acaafc8662d0527dbe1b8a28b790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5673acaafc8662d0527dbe1b8a28b790">&#9670;&#160;</a></span>div_h()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::div_h </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jbsupsmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jbsupumnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jbsupvmnh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the divergence of a half grid quantity. </p>
<p>This operator is used for unit testing of the curl operator. Divergence is defined as</p>
<p>DIV(B) = 1/sqrt(g)d/dx (JB^x} for x = s,u,v (1)</p>
<p>Note for testing that divergence remains zero, add a 1/sqrt(g) term is not necessary to retain.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jasupsmnh</td><td>Contravariant vector in the s direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jasupsmnh</td><td>Contravariant vector in the u direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jasupsmnh</td><td>Contravariant vector in the v direction half grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">divmnf</td><td>Diverence on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a01bacb665908fabbf43dabb56cae2e20" name="a01bacb665908fabbf43dabb56cae2e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01bacb665908fabbf43dabb56cae2e20">&#9670;&#160;</a></span>gradientfull()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::gradientfull </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gradientf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>vech</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the gradient to the full mesh from a half mesh quantity. </p>
<p>The arrays must be passed in as ALLOCATABLE to preserve the array bounds. There are three scenarios we need to anticipate for the radial dimension. The easiest is when the upper bound of gradientf matches vech. Otherwise vech can be the full ns range of one more than the gradientf. To handle this an extra is calculated which can be a maximum of one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gradientf</td><td>Gradient on the full grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vech</td><td>Half grid quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a01ba55178440836b2eeb8dc1ea00b222" name="a01ba55178440836b2eeb8dc1ea00b222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01ba55178440836b2eeb8dc1ea00b222">&#9670;&#160;</a></span>gradienthalf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfaceutilities_1_1gradienthalf.html">utilities::gradienthalf</a> </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gradienth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>vecf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the gradient to the half mesh from a full mesh quantity. </p>
<p>The arrays must be passed in as ALLOCATABLE to preserve the array bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gradienth</td><td>Gradient on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vecf</td><td>Full grid quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a930e09a0285c4594d26ccc7489eca6c5" name="a930e09a0285c4594d26ccc7489eca6c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930e09a0285c4594d26ccc7489eca6c5">&#9670;&#160;</a></span>gradienthalf_p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::gradienthalf_p </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gradienth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), pointer&#160;</td>
          <td class="paramname"><em>vecf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the gradient to the half mesh from a full mesh quantity. </p>
<p>The arrays must be passed in as ALLOCATABLE to preserve the array bounds. Full vector is passed in as a pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">gradienth</td><td>Gradient on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vecf</td><td>Full grid quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9e6a8da8f9874f6e6fcec023e6964c2f" name="a9e6a8da8f9874f6e6fcec023e6964c2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e6a8da8f9874f6e6fcec023e6964c2f">&#9670;&#160;</a></span>set_bndy_fouier_m0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine <a class="el" href="interfaceutilities_1_1set__bndy__fouier__m0.html">utilities::set_bndy_fouier_m0</a> </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set vector fourier conditions. </p>
<p>For fouier modes for m=0 and for the negative n modes. The n=0 modes are zero for quantities with sin parity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amn</td><td>Fourier quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fouier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a969bf9187692dd68e7b48a00f70f372d" name="a969bf9187692dd68e7b48a00f70f372d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a969bf9187692dd68e7b48a00f70f372d">&#9670;&#160;</a></span>set_bndy_fouier_m0_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine utilities::set_bndy_fouier_m0_vec </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set vector fourier conditions. </p>
<p>For fouier modes for m=0 and for the negative n modes. The n=0 modes are zero for quantities with sin parity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amns</td><td>Fourier quantity for s component. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnu</td><td>Fourier quantity for u component. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnv</td><td>Fourier quantity for v component. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Fouier parity flag. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aefb81c8bfa3087cdaad4c2617e4383df" name="aefb81c8bfa3087cdaad4c2617e4383df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefb81c8bfa3087cdaad4c2617e4383df">&#9670;&#160;</a></span>set_bndy_full_origin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine utilities::set_bndy_full_origin </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnsf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnvf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply origin vector boundary conditions. </p>
<p>At the center of the grid, a vector quantity should have only m=1 modes in the s direction, no modes in the u direction and only m=0 modes in the v direction. See siesta_init::GetFields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnsf</td><td>Full grid fourier quantity for s component. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnuf</td><td>Full grid fourier quantity for u component. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnvf</td><td>Full grid fourier quantity for v component. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Control flags. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa8f338cb8baf6e5037a88ab897404521" name="aa8f338cb8baf6e5037a88ab897404521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f338cb8baf6e5037a88ab897404521">&#9670;&#160;</a></span>set_bndy_half_to_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine utilities::set_bndy_half_to_full </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>amnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set fouier boundary conditions for full grid quantity converted from half grid. </p>
<p>At the center of the grid, the quantity should not be a function of u so all m &gt; 0 modes should be zero. For the m = 0 terms, use the value from the half grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">amnh</td><td>Half grid fourier quantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnf</td><td>Full grid fourier quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Control flags. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad6e45cf4046669d9fabd21ebd8d16f1b" name="ad6e45cf4046669d9fabd21ebd8d16f1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e45cf4046669d9fabd21ebd8d16f1b">&#9670;&#160;</a></span>set_bndy_half_to_full_ds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine utilities::set_bndy_half_to_full_ds </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>amnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>amnf_ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set fouier boundary conditions for full grid radial derivative quantity converted from half grid. </p>
<p>At the center of the grid the the m=1 quanity flips size across the s=0 point. The results in a doubling of the m=1 component for the first half grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">amnh</td><td>Half grid fourier quantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">amnf_ds</td><td>Full grid radial derivative fourier quantity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Control flags. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3595a7fa86d5b7714483cc9cb05ff00f" name="a3595a7fa86d5b7714483cc9cb05ff00f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3595a7fa86d5b7714483cc9cb05ff00f">&#9670;&#160;</a></span>test_div()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function utilities::test_div </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jbsupsmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jbsupumnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jbsupvmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>parity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsmin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test divergence of a half grid quantity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jbsupsmnh</td><td>Contravariant vector in the s direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jbsupumnh</td><td>Contravariant vector in the u direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jbsupvmnh</td><td>Contravariant vector in the v direction half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity flag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmin</td><td>Minimum radial index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsmax</td><td>Maximum radial index. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a365a15cb83921febb9278a6a9b158079" name="a365a15cb83921febb9278a6a9b158079"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a365a15cb83921febb9278a6a9b158079">&#9670;&#160;</a></span>test_utilities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function utilities::test_utilities</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test utility routines. </p>
<p>Test the various operations of in the <a class="el" href="namespaceutilities.html">utilities</a> module. Current tests check:</p>
<ul>
<li>Check the div(curl(A)) is identially zero. </li>
</ul>

</div>
</div>
<a id="a001873e5aa19fce5d04482dde1e081bd" name="a001873e5aa19fce5d04482dde1e081bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a001873e5aa19fce5d04482dde1e081bd">&#9670;&#160;</a></span>to_full_mesh2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::to_full_mesh2 </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>vech</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>vecf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Migrate a two dimensional quantity form the half mesh to the full mesh. </p>
<p>First and last point are extrapolated linearly. The arrays must be passed in as ALLOCATABLE to preserve the array bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vech</td><td>Half mesh qantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vecf</td><td>Full mesh quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa39bbeefd09bd82b946d1ac38e7856ae" name="aa39bbeefd09bd82b946d1ac38e7856ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa39bbeefd09bd82b946d1ac38e7856ae">&#9670;&#160;</a></span>to_full_mesh3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::to_full_mesh3 </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>vech</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>vecf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Migrate a three dimensional quantity form the half mesh to the full mesh. </p>
<p>First and last point are extrapolated linearly. The arrays must be passed in as ALLOCATABLE to preserve the array bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vech</td><td>Half mesh qantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vecf</td><td>Full mesh quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa56fb8ab863c6128f936e34a3028c8f0" name="aa56fb8ab863c6128f936e34a3028c8f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa56fb8ab863c6128f936e34a3028c8f0">&#9670;&#160;</a></span>to_half_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine <a class="el" href="interfaceutilities_1_1to__half__mesh.html">utilities::to_half_mesh</a> </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>vecf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>vech</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Migrates a full mesh quantity to the half mesh. </p>
<p>The arrays must be passed in as ALLOCATABLE to preserve the array bounds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vecf</td><td>Full grid quantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vech</td><td>Half grid quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a396f6885db6a18350a572b6df1b58195" name="a396f6885db6a18350a572b6df1b58195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a396f6885db6a18350a572b6df1b58195">&#9670;&#160;</a></span>to_half_mesh_p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine utilities::to_half_mesh_p </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), pointer&#160;</td>
          <td class="paramname"><em>vecf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>vech</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Migrates a full mesh quantity to the half mesh. </p>
<p>The arrays must be passed in as ALLOCATABLE to preserve the array bounds. Full vector grid is passed in as pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vecf</td><td>Full grid quantity. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vech</td><td>Half grid quantity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceutilities.html">utilities</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
