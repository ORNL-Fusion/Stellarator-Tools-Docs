<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: siesta_force Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">siesta_force Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compute the JxB - Grad(p) covariant force components. The plasma is in equilibrium when the force of the magnetic pressure balances the plasma pressure.  
<a href="namespacesiesta__force.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a02e0516a91fb8f6abcd965a1c5037c6c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#a02e0516a91fb8f6abcd965a1c5037c6c">update_force</a></td></tr>
<tr class="memdesc:a02e0516a91fb8f6abcd965a1c5037c6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update MHD forces on full radial mesh.  <a href="namespacesiesta__force.html#a02e0516a91fb8f6abcd965a1c5037c6c">More...</a><br /></td></tr>
<tr class="separator:a02e0516a91fb8f6abcd965a1c5037c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe9c159a52351787dcfbd135bd6dfd0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#a1fe9c159a52351787dcfbd135bd6dfd0">incfields</a> (jbsupsmnh, jbsupumnh, jbsupvmnh, jpmnh,</td></tr>
<tr class="memdesc:a1fe9c159a52351787dcfbd135bd6dfd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute nonlinear or linearized contravariant magnetic field components and pressure in real space.  <a href="namespacesiesta__force.html#a1fe9c159a52351787dcfbd135bd6dfd0">More...</a><br /></td></tr>
<tr class="separator:a1fe9c159a52351787dcfbd135bd6dfd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d3a3e49372864458cb7f9aa83b7712"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#a89d3a3e49372864458cb7f9aa83b7712">lorentz</a> (bsupsijf, bsupuijf, bsupvijf,</td></tr>
<tr class="memdesc:a89d3a3e49372864458cb7f9aa83b7712"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute covariant (sub) real-space components of the Lorentz K X B force.  <a href="namespacesiesta__force.html#a89d3a3e49372864458cb7f9aa83b7712">More...</a><br /></td></tr>
<tr class="separator:a89d3a3e49372864458cb7f9aa83b7712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad77a5b26b47f1b280cb4bfed48acd990"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#ad77a5b26b47f1b280cb4bfed48acd990">getmhdforce</a> (fsubsmnf, fsubumnf, fsubvmnf, pijh,</td></tr>
<tr class="memdesc:ad77a5b26b47f1b280cb4bfed48acd990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute covariant (sub) components of the MHD force J X B - grad(p).  <a href="namespacesiesta__force.html#ad77a5b26b47f1b280cb4bfed48acd990">More...</a><br /></td></tr>
<tr class="separator:ad77a5b26b47f1b280cb4bfed48acd990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a1cb0b71fc5b8575531f003b0d27e0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#ac6a1cb0b71fc5b8575531f003b0d27e0">initpardamping</a> (parscale, pardamp)</td></tr>
<tr class="memdesc:ac6a1cb0b71fc5b8575531f003b0d27e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute scaling factors for parallel flow damping.  <a href="namespacesiesta__force.html#ac6a1cb0b71fc5b8575531f003b0d27e0">More...</a><br /></td></tr>
<tr class="separator:ac6a1cb0b71fc5b8575531f003b0d27e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2bd1ea1649cf0a2c203ae7d33a5dc2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#aba2bd1ea1649cf0a2c203ae7d33a5dc2">get_force_harmonics</a> (pardamp, f_smnf, f_umnf, f_vmnf, pa</td></tr>
<tr class="memdesc:aba2bd1ea1649cf0a2c203ae7d33a5dc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Final computation of the MHD covariant Fourier force components.  <a href="namespacesiesta__force.html#aba2bd1ea1649cf0a2c203ae7d33a5dc2">More...</a><br /></td></tr>
<tr class="separator:aba2bd1ea1649cf0a2c203ae7d33a5dc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a50687337ce61a2a3abecf80ba92739"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesiesta__force.html#a4a50687337ce61a2a3abecf80ba92739">addpardamping</a> (pardamp, f_smnf, f_umnf, f_vmnf,</td></tr>
<tr class="memdesc:a4a50687337ce61a2a3abecf80ba92739"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add parallel flow damping terms to forces (for Hessian calculation) to suppress null space at resonances.  <a href="namespacesiesta__force.html#a4a50687337ce61a2a3abecf80ba92739">More...</a><br /></td></tr>
<tr class="separator:a4a50687337ce61a2a3abecf80ba92739"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compute the JxB - Grad(p) covariant force components. The plasma is in equilibrium when the force of the magnetic pressure balances the plasma pressure. </p>
<pre class="fragment">F = J X B - Grad(p) = 0                                               (1)
</pre><p> where J is the current density. Updates for B (dB) and p (dp) were computed in <a class="el" href="namespacesiesta__bfield.html">siesta_bfield</a> and <a class="el" href="namespacesiesta__pressure.html">siesta_pressure</a>, respectively.</p>
<p>B_i+1 = B_i + dB (2a)</p>
<p>p_i+1 = p_i + dp (2b)</p>
<p>Note that the magnetic field and pressure terms contain a Jacobian factor. Updated current density can be found from the updated magnetic field.</p>
<p>J = Curl(B)/mu0 (3)</p>
<p>Actual computation of the contravariant current components is implimented in cv_currents. The curvilinear coordinates, the J X B term becomes</p>
<p>(J X B)_s = (K^u*B^v - K^v*B^u) (4a)</p>
<p>(J X B)_u = (K^v*B^s - K^s*B^v) (4b)</p>
<p>(J X B)_v = (K^s*B^u - K^u*B^s) (4c)</p>
<p>where K^i = sqrt(g) J^i. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a4a50687337ce61a2a3abecf80ba92739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a50687337ce61a2a3abecf80ba92739">&#9670;&nbsp;</a></span>addpardamping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::addpardamping </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>pardamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>f_smnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>f_umnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>f_vmnf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add parallel flow damping terms to forces (for Hessian calculation) to suppress null space at resonances. </p>
<p>Compute parallel (to B) damping force and add it to (linearized) forces to suppress null space in preconditioner.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f_smnf</td><td>Covariant component of the mhd force in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f_umnf</td><td>Covariant component of the mhd force in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f_vmnf</td><td>Covariant component of the mhd force in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jvsupsmnf</td><td>Contravariant displacement in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jvsupsmnf</td><td>Contravariant displacement in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jvsupsmnf</td><td>Contravariant displacement in the v direction. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aba2bd1ea1649cf0a2c203ae7d33a5dc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2bd1ea1649cf0a2c203ae7d33a5dc2">&#9670;&nbsp;</a></span>get_force_harmonics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::get_force_harmonics </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>pardamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>f_smnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>f_umnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>f_vmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Final computation of the MHD covariant Fourier force components. </p>
<p>Add pressure gradients and parallel damping (to Hessian), and scale and print boundary values. See siesta_init::GetFields for boundary conditions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pardamp</td><td>Parallel damping. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f_smnf</td><td>Covariant component of the mhd force in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f_umnf</td><td>Covariant component of the mhd force in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f_vmnf</td><td>Covariant component of the mhd force in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity of the fourier components. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad77a5b26b47f1b280cb4bfed48acd990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad77a5b26b47f1b280cb4bfed48acd990">&#9670;&nbsp;</a></span>getmhdforce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::getmhdforce </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>fsubsmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>fsubumnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>fsubvmnf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>pijh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute covariant (sub) components of the MHD force J X B - grad(p). </p>
<p>The MHD forces are sum of Lorentz and pressure gradient forces</p>
<p>F = J X B - Grad(p) (1)</p>
<p>where J is the plasma current density. In curvilinear coodinates, the forces components becomes</p>
<p>F_s = (K^u*B^v - K^v*B^u) - dp/ds (2a)</p>
<p>F_u = (K^v*B^s - K^s*B^v) - dp/du (2b)</p>
<p>F_v = (K^s*B^u - K^u*B^s) - dp/dv (2c)</p>
<p>where K^i = sqrt(g)*J^i . Note this routine works on one parity at a time. When l_linearize is true, calculate the perturbed Force only (Ignores F(xc=0) part). When l_linearize is false, calculate full non-linear force(F(xc=0) part only)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fsubsmnf</td><td>Covariant force in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fsubumnf</td><td>Covariant force in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fsubvmnf</td><td>Covariant force in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pijh</td><td>Real space pressure. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KxBsij</td><td>Covariant component of the lorentz force in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KxBuij</td><td>Covariant component of the lorentz force in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KxBvij</td><td>Covariant component of the lorentz force in the v direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pardamp</td><td>Parallel damping. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">parity</td><td>Parity of the fourier components. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1fe9c159a52351787dcfbd135bd6dfd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fe9c159a52351787dcfbd135bd6dfd0">&#9670;&nbsp;</a></span>incfields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::incfields </td>
          <td>(</td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jbsupsmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jbsupumnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jbsupvmnh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:,:), intent(in), allocatable&#160;</td>
          <td class="paramname"><em>jpmnh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute nonlinear or linearized contravariant magnetic field components and pressure in real space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jbsupsmnh</td><td>Contravariant B field in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jbsupumnh</td><td>Contravariant B field in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jbsupvmnh</td><td>Contravariant B field in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jpmnh</td><td>Pressure on the half grid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">djbsupsmnh</td><td>Contravariant B field perturbation in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">djbsupumnh</td><td>Contravariant B field perturbation in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">djbsupvmnh</td><td>Contravariant B field perturbation in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">djpmnh</td><td>Pressure perturbation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jbsupsijh</td><td>Real space contravariant B field in the s direction. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jbsupuijh</td><td>Real space contravariant B field in the u !direction. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jbsupvijh</td><td>Real space contravariant B field in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iparity</td><td>Fourier parity. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac6a1cb0b71fc5b8575531f003b0d27e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6a1cb0b71fc5b8575531f003b0d27e0">&#9670;&nbsp;</a></span>initpardamping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::initpardamping </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>parscale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (dp), dimension(:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>pardamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute scaling factors for parallel flow damping. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">parscale</td><td>Scratch array. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pardamp</td><td>Parallel damping. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a89d3a3e49372864458cb7f9aa83b7712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d3a3e49372864458cb7f9aa83b7712">&#9670;&nbsp;</a></span>lorentz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::lorentz </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bsupsijf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bsupuijf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bsupvijf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute covariant (sub) real-space components of the Lorentz K X B force. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupsijf</td><td>Contravariant component of the B field in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupuijf</td><td>Contravariant component of the B field in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bsupvijf</td><td>Contravariant component of the B field in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksupsijf</td><td>Contravariant component of the current in the s direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksupuijf</td><td>Contravariant component of the current in the u direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksupvijf</td><td>Contravariant component of the current in the v direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KxBsij</td><td>Covariant component of the lorentz force in the s direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KxBuij</td><td>Covariant component of the lorentz force in the u direction. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KxBvij</td><td>Covariant component of the lorentz force in the v direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fcomb</td><td>Control flag to sum the components with previous values. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a02e0516a91fb8f6abcd965a1c5037c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02e0516a91fb8f6abcd965a1c5037c6c">&#9670;&nbsp;</a></span>update_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine siesta_force::update_force</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update MHD forces on full radial mesh. </p>
<p>Updates force using the advanced values of B and p obtained from calls to <a class="el" href="namespacesiesta__pressure.html#a7c4ad4ede03c93bc7e5ad31ccdfa9f50">siesta_pressure::update_pres</a> and <a class="el" href="namespacesiesta__bfield.html#a90f25fe7e41fcc537d67390288294b87">siesta_bfield::update_bfield</a> Update values of fsub*mn*f stored in quantities. Linearized force is</p>
<p>Flin ~ delta_v</p>
<p>has only the linear part. Not DC part and not non-linear. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
