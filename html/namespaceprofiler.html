<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: profiler Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">profiler Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines functions for measuring an tabulating performance of function and subroutine calls. These routines are only active when the PROFILE_ON macro is defined.  
<a href="namespaceprofiler.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structprofiler_1_1profiler__bucket.html">profiler_bucket</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full table of profiled functions.  <a href="structprofiler_1_1profiler__bucket.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ab266b6acb4f5255931690b43d31780e5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#ab266b6acb4f5255931690b43d31780e5">profiler_construct</a> ()</td></tr>
<tr class="memdesc:ab266b6acb4f5255931690b43d31780e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a profiler.  <a href="namespaceprofiler.html#ab266b6acb4f5255931690b43d31780e5">More...</a><br /></td></tr>
<tr class="separator:ab266b6acb4f5255931690b43d31780e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641db19a17afa3c6f3084c859aa86aa1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#a641db19a17afa3c6f3084c859aa86aa1">profiler_destruct</a> ()</td></tr>
<tr class="memdesc:a641db19a17afa3c6f3084c859aa86aa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deconstruct a profiler.  <a href="namespaceprofiler.html#a641db19a17afa3c6f3084c859aa86aa1">More...</a><br /></td></tr>
<tr class="separator:a641db19a17afa3c6f3084c859aa86aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5df6115cae0fb6066c65922c4c34240"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#af5df6115cae0fb6066c65922c4c34240">profiler_set_stop_time</a> (symbol_name, start_time)</td></tr>
<tr class="memdesc:af5df6115cae0fb6066c65922c4c34240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the end time of profiled function.  <a href="namespaceprofiler.html#af5df6115cae0fb6066c65922c4c34240">More...</a><br /></td></tr>
<tr class="separator:af5df6115cae0fb6066c65922c4c34240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36371403894ef9b960bac1e58aef5033"><td class="memItemLeft" align="right" valign="top">real(rprec) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#a36371403894ef9b960bac1e58aef5033">profiler_get_start_time</a> ()</td></tr>
<tr class="memdesc:a36371403894ef9b960bac1e58aef5033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the start time of profiled function.  <a href="namespaceprofiler.html#a36371403894ef9b960bac1e58aef5033">More...</a><br /></td></tr>
<tr class="separator:a36371403894ef9b960bac1e58aef5033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac00fd28da21b60f054b396a00c6546ae"><td class="memItemLeft" align="right" valign="top">recursive subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#ac00fd28da21b60f054b396a00c6546ae">profiler_sort</a> (low_index, high_index)</td></tr>
<tr class="memdesc:ac00fd28da21b60f054b396a00c6546ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sorts the profile table based on the average call time.  <a href="namespaceprofiler.html#ac00fd28da21b60f054b396a00c6546ae">More...</a><br /></td></tr>
<tr class="separator:ac00fd28da21b60f054b396a00c6546ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a824701798f5229e743f741d4655526ab"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#a824701798f5229e743f741d4655526ab">profiler_hash_function</a> (symbol_name)</td></tr>
<tr class="memdesc:a824701798f5229e743f741d4655526ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a hash for the symbol name.  <a href="namespaceprofiler.html#a824701798f5229e743f741d4655526ab">More...</a><br /></td></tr>
<tr class="separator:a824701798f5229e743f741d4655526ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0770360f61f6885a34f3983a4ad9625b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#a0770360f61f6885a34f3983a4ad9625b">profiler_write</a> (iou)</td></tr>
<tr class="memdesc:a0770360f61f6885a34f3983a4ad9625b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out the profiled data to an output file.  <a href="namespaceprofiler.html#a0770360f61f6885a34f3983a4ad9625b">More...</a><br /></td></tr>
<tr class="separator:a0770360f61f6885a34f3983a4ad9625b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8198497a26b6fc30d31c623f7aee2dd3"><td class="memItemLeft" align="right" valign="top"><a id="a8198497a26b6fc30d31c623f7aee2dd3"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#a8198497a26b6fc30d31c623f7aee2dd3">profiler_string_size</a> = 68</td></tr>
<tr class="memdesc:a8198497a26b6fc30d31c623f7aee2dd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max string length. <br /></td></tr>
<tr class="separator:a8198497a26b6fc30d31c623f7aee2dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa864b887a08e8026d904ade234c18b5a"><td class="memItemLeft" align="right" valign="top"><a id="aa864b887a08e8026d904ade234c18b5a"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#aa864b887a08e8026d904ade234c18b5a">profiler_bucket_size</a> = 1000</td></tr>
<tr class="memdesc:aa864b887a08e8026d904ade234c18b5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max number of buckets. <br /></td></tr>
<tr class="separator:aa864b887a08e8026d904ade234c18b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc9a352239240fe921860cfaba7fea42"><td class="memItemLeft" align="right" valign="top"><a id="afc9a352239240fe921860cfaba7fea42"></a>
type(<a class="el" href="structprofiler_1_1profiler__bucket.html">profiler_bucket</a>), dimension(<a class="el" href="namespaceprofiler.html#aa864b887a08e8026d904ade234c18b5a">profiler_bucket_size</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprofiler.html#afc9a352239240fe921860cfaba7fea42">buckets</a></td></tr>
<tr class="memdesc:afc9a352239240fe921860cfaba7fea42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of buckets to hold the values. <br /></td></tr>
<tr class="separator:afc9a352239240fe921860cfaba7fea42"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines functions for measuring an tabulating performance of function and subroutine calls. These routines are only active when the PROFILE_ON macro is defined. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ab266b6acb4f5255931690b43d31780e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab266b6acb4f5255931690b43d31780e5">&#9670;&nbsp;</a></span>profiler_construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine profiler::profiler_construct</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a profiler. </p>
<p>This only sets up OpenMP locks if OpenMP support is compiled in. The profile table uses a fixed memory size in global memory. </p>

</div>
</div>
<a id="a641db19a17afa3c6f3084c859aa86aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641db19a17afa3c6f3084c859aa86aa1">&#9670;&nbsp;</a></span>profiler_destruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine profiler::profiler_destruct</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deconstruct a profiler. </p>
<p>This only destroys OpenMP locks if OpenMP support is compiled in. The profile table uses a fixed memory size in global memory. </p>

</div>
</div>
<a id="a36371403894ef9b960bac1e58aef5033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36371403894ef9b960bac1e58aef5033">&#9670;&nbsp;</a></span>profiler_get_start_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (rprec) function profiler::profiler_get_start_time</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the start time of profiled function. </p>
<p>Gets a starting time of a function. When profiling is turned off, this returns 0 instead.</p>
<dl class="section return"><dt>Returns</dt><dd>The start time of a function. </dd></dl>

</div>
</div>
<a id="a824701798f5229e743f741d4655526ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a824701798f5229e743f741d4655526ab">&#9670;&nbsp;</a></span>profiler_hash_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function profiler::profiler_hash_function </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>symbol_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a hash for the symbol name. </p>
<p>The hash is computed using the djb2 algorithm. </p><pre class="fragment">hash_0 = 5381
hash_i+1 = hash_i * 33 ^ c_i
</pre><p> The magic numbers of 5381 and 33 help the hash function avoid collision and good distribution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">symbol_name</td><td>Name of the symbol to hash. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The hash value of the symbol. </dd></dl>

</div>
</div>
<a id="af5df6115cae0fb6066c65922c4c34240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5df6115cae0fb6066c65922c4c34240">&#9670;&nbsp;</a></span>profiler_set_stop_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine profiler::profiler_set_stop_time </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>symbol_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (rprec), intent(in)&#160;</td>
          <td class="paramname"><em>start_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the end time of profiled function. </p>
<p>Sets the end time of profiled function and adds the result to the table. The symbol name is hashed to determine the index of the array it lives in. If the index is full, the next instance is used. When profiling is turned off, this does nothing. To avoid race conditons in multi threaded code, this must only be run by one thread or process at a time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">symbol_name</td><td>Name of the symbol to profile. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">start_time</td><td>Starting time of the symbol call. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac00fd28da21b60f054b396a00c6546ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac00fd28da21b60f054b396a00c6546ae">&#9670;&nbsp;</a></span>profiler_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">recursive subroutine profiler::profiler_sort </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>low_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>high_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sorts the profile table based on the average call time. </p>
<p>A recursive merge sort algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">low_index</td><td>Lower index to sort. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">high_index</td><td>Higher index to sort. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0770360f61f6885a34f3983a4ad9625b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0770360f61f6885a34f3983a4ad9625b">&#9670;&nbsp;</a></span>profiler_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine profiler::profiler_write </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iou</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write out the profiled data to an output file. </p>
<p>This loops through the buckets and prints out the profiled data. Any empty buckets get skiped.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iou</td><td>Input/output unit of the output file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
