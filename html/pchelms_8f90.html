<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Stellarator-Tools: SIESTA/Sources/pchelms.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flux_surfaces.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Stellarator-Tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_39c98a4a63708bac2753b196e90e71c6.html">SIESTA</a></li><li class="navelem"><a class="el" href="dir_1d62828a5cde32d788198c3ddc1e7414.html">Sources</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">pchelms.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains module <a class="el" href="namespacepchelms.html">pchelms</a>.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacepchelms"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html">pchelms</a></td></tr>
<tr class="memdesc:namespacepchelms"><td class="mdescLeft">&#160;</td><td class="mdescRight">This file solves the helmholtz equation to set inital fields that match vmec and vacuum currents from the vector potential. Initial vector potential on the edge is supplied by the BMW code. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2c9081a3fa287a5c82639d814e12a54f"><td class="memItemLeft" align="right" valign="top"><a id="a2c9081a3fa287a5c82639d814e12a54f"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a2c9081a3fa287a5c82639d814e12a54f">pchelms::run_pchelms</a></td></tr>
<tr class="memdesc:a2c9081a3fa287a5c82639d814e12a54f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the pchelms code to solve for inital jbsup values. <br /></td></tr>
<tr class="separator:a2c9081a3fa287a5c82639d814e12a54f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5cddc82bbffdf9a2c6e96d607ba90e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#aec5cddc82bbffdf9a2c6e96d607ba90e">pchelms::curla_pchelms</a> (Asubsmnf, Asubumnf, Asubvmnf,</td></tr>
<tr class="memdesc:aec5cddc82bbffdf9a2c6e96d607ba90e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute real-space components of contravariant jac*B^i on half radial grid from curl(A).  <a href="namespacepchelms.html#aec5cddc82bbffdf9a2c6e96d607ba90e">More...</a><br /></td></tr>
<tr class="separator:aec5cddc82bbffdf9a2c6e96d607ba90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c588539b11ef597d1f30c6397af78a6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a5c588539b11ef597d1f30c6397af78a6">pchelms::curlb_pchelms</a> (ksupsmnf, ksupumnf, ksupvmnf, asubsmnf,</td></tr>
<tr class="memdesc:a5c588539b11ef597d1f30c6397af78a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute real-space components of contravariant jac*J^i on full radial grid from curl(B).  <a href="namespacepchelms.html#a5c588539b11ef597d1f30c6397af78a6">More...</a><br /></td></tr>
<tr class="separator:a5c588539b11ef597d1f30c6397af78a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e988318d4f7538797336068e91fe5fa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a3e988318d4f7538797336068e91fe5fa">pchelms::cyl2vmec_a</a> (A_r, A_p, A_z, cA_s, cA_u, cA_v)</td></tr>
<tr class="memdesc:a3e988318d4f7538797336068e91fe5fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert cylindical vector potential to contravariant components.  <a href="namespacepchelms.html#a3e988318d4f7538797336068e91fe5fa">More...</a><br /></td></tr>
<tr class="separator:a3e988318d4f7538797336068e91fe5fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055dc5013104e1119dcfd6c8b99b65c6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a055dc5013104e1119dcfd6c8b99b65c6">pchelms::get_e_s</a> (rij_h, zij_h, rs, zs, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a055dc5013104e1119dcfd6c8b99b65c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the e_s basis vector.  <a href="namespacepchelms.html#a055dc5013104e1119dcfd6c8b99b65c6">More...</a><br /></td></tr>
<tr class="separator:a055dc5013104e1119dcfd6c8b99b65c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a165514a8e63c16e7afd2f4404e4c03ad"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a165514a8e63c16e7afd2f4404e4c03ad">pchelms::init_a</a> (cA_s, cA_u, cA_v, A_s, A_u, A_v, <a class="el" href="classparity.html">parity</a>)</td></tr>
<tr class="memdesc:a165514a8e63c16e7afd2f4404e4c03ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize vector potential.  <a href="namespacepchelms.html#a165514a8e63c16e7afd2f4404e4c03ad">More...</a><br /></td></tr>
<tr class="separator:a165514a8e63c16e7afd2f4404e4c03ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac5e7cf44bc7d222874c152b0dce61b5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#aac5e7cf44bc7d222874c152b0dce61b5">pchelms::init_f</a> (Fsupsmn, Fsupumn, Fsupvmn, jcurrumn, jcurrvmn, p</td></tr>
<tr class="memdesc:aac5e7cf44bc7d222874c152b0dce61b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize expected currents.  <a href="namespacepchelms.html#aac5e7cf44bc7d222874c152b0dce61b5">More...</a><br /></td></tr>
<tr class="separator:aac5e7cf44bc7d222874c152b0dce61b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bac7a0e1bf89a7618e5a0092eca9856"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a1bac7a0e1bf89a7618e5a0092eca9856">pchelms::compare_current</a> (Fsupsmn, Fsupumn, Fsupvmn, jcurrumn, jc</td></tr>
<tr class="memdesc:a1bac7a0e1bf89a7618e5a0092eca9856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare Curl(Curl(A)) with the expected VMEC and vacuum currents.  <a href="namespacepchelms.html#a1bac7a0e1bf89a7618e5a0092eca9856">More...</a><br /></td></tr>
<tr class="separator:a1bac7a0e1bf89a7618e5a0092eca9856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fde1f18d2db817c31be925702ca27a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a11fde1f18d2db817c31be925702ca27a">pchelms::dump_b</a> (js, iunit)</td></tr>
<tr class="memdesc:a11fde1f18d2db817c31be925702ca27a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write out magnetic field to file.  <a href="namespacepchelms.html#a11fde1f18d2db817c31be925702ca27a">More...</a><br /></td></tr>
<tr class="separator:a11fde1f18d2db817c31be925702ca27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a225289b1f437428784e431152a2f2"><td class="memItemLeft" align="right" valign="top"><a id="aa3a225289b1f437428784e431152a2f2"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#aa3a225289b1f437428784e431152a2f2">pchelms::getfsq_pchelms</a></td></tr>
<tr class="memdesc:aa3a225289b1f437428784e431152a2f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The the current residual. <br /></td></tr>
<tr class="separator:aa3a225289b1f437428784e431152a2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03bada0ad4661ef892054eddba4279c5"><td class="memItemLeft" align="right" valign="top"><a id="a03bada0ad4661ef892054eddba4279c5"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a03bada0ad4661ef892054eddba4279c5">pchelms::cleanup</a></td></tr>
<tr class="memdesc:a03bada0ad4661ef892054eddba4279c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate arrays. <br /></td></tr>
<tr class="separator:a03bada0ad4661ef892054eddba4279c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7fc7b067cc3b6ee467368fd4be9ef68"><td class="memItemLeft" align="right" valign="top"><a id="ab7fc7b067cc3b6ee467368fd4be9ef68"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#ab7fc7b067cc3b6ee467368fd4be9ef68">pchelms::check_current</a></td></tr>
<tr class="memdesc:ab7fc7b067cc3b6ee467368fd4be9ef68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that the line integral of Bsubuij equals the integrated toroidal current. <br /></td></tr>
<tr class="separator:ab7fc7b067cc3b6ee467368fd4be9ef68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92c8f2b18acd0ab05820b19beb32b73"><td class="memItemLeft" align="right" valign="top"><a id="ab92c8f2b18acd0ab05820b19beb32b73"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#ab92c8f2b18acd0ab05820b19beb32b73">pchelms::compute_forces_lin</a></td></tr>
<tr class="memdesc:ab92c8f2b18acd0ab05820b19beb32b73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute linear forces. <br /></td></tr>
<tr class="separator:ab92c8f2b18acd0ab05820b19beb32b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59257cee16eee714e41df5a755e5db8d"><td class="memItemLeft" align="right" valign="top"><a id="a59257cee16eee714e41df5a755e5db8d"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a59257cee16eee714e41df5a755e5db8d">pchelms::backslv</a></td></tr>
<tr class="memdesc:a59257cee16eee714e41df5a755e5db8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update solution. <br /></td></tr>
<tr class="separator:a59257cee16eee714e41df5a755e5db8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8943c1709ac343912f095a522c2f40"><td class="memItemLeft" align="right" valign="top"><a id="a6b8943c1709ac343912f095a522c2f40"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a6b8943c1709ac343912f095a522c2f40">pchelms::init_pchelms</a></td></tr>
<tr class="memdesc:a6b8943c1709ac343912f095a522c2f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize helmholtz solver. <br /></td></tr>
<tr class="separator:a6b8943c1709ac343912f095a522c2f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcfa1bab3a50f95f1f72a6f8b8cc988d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#afcfa1bab3a50f95f1f72a6f8b8cc988d">pchelms::compute_forces</a> (lNLinear)</td></tr>
<tr class="memdesc:afcfa1bab3a50f95f1f72a6f8b8cc988d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Fourier components of Curl(Curl(A)) - mu0J operator on full radial grid.  <a href="namespacepchelms.html#afcfa1bab3a50f95f1f72a6f8b8cc988d">More...</a><br /></td></tr>
<tr class="separator:afcfa1bab3a50f95f1f72a6f8b8cc988d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cae02545c78f51ab7c3841373b05c55"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a6cae02545c78f51ab7c3841373b05c55">pchelms::boundaryconditions</a> (Fsupsmn, Fsupumn, Fsupvmn, iparity)</td></tr>
<tr class="memdesc:a6cae02545c78f51ab7c3841373b05c55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply boundary conditions.  <a href="namespacepchelms.html#a6cae02545c78f51ab7c3841373b05c55">More...</a><br /></td></tr>
<tr class="separator:a6cae02545c78f51ab7c3841373b05c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835b9933774c798db9d3af83abd8f811"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#a835b9933774c798db9d3af83abd8f811">pchelms::gmres_pchelms</a></td></tr>
<tr class="memdesc:a835b9933774c798db9d3af83abd8f811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup and run GMRES solver for the helmholtz problem.  <a href="namespacepchelms.html#a835b9933774c798db9d3af83abd8f811">More...</a><br /></td></tr>
<tr class="separator:a835b9933774c798db9d3af83abd8f811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab999d3174651fcdde4208231de35279c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#ab999d3174651fcdde4208231de35279c">pchelms::matvec_pchelms</a> (p, Ap, ndim)</td></tr>
<tr class="memdesc:ab999d3174651fcdde4208231de35279c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serial callback function for MatVec GMRES routine.  <a href="namespacepchelms.html#ab999d3174651fcdde4208231de35279c">More...</a><br /></td></tr>
<tr class="separator:ab999d3174651fcdde4208231de35279c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc36a9db8401258f3d4e3b6415e6dfda"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#afc36a9db8401258f3d4e3b6415e6dfda">pchelms::matvec_par_pchelms</a> (ploc, Ap, nloc)</td></tr>
<tr class="memdesc:afc36a9db8401258f3d4e3b6415e6dfda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallel callback function for MatVec GMRES routine.  <a href="namespacepchelms.html#afc36a9db8401258f3d4e3b6415e6dfda">More...</a><br /></td></tr>
<tr class="separator:afc36a9db8401258f3d4e3b6415e6dfda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad89a7b4e5adb8613efe6fa04700598a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepchelms.html#aad89a7b4e5adb8613efe6fa04700598a">pchelms::getnlforce_pchelms</a> (xcstate, fsq_nl, bnorm)</td></tr>
<tr class="memdesc:aad89a7b4e5adb8613efe6fa04700598a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non linear force callback.  <a href="namespacepchelms.html#aad89a7b4e5adb8613efe6fa04700598a">More...</a><br /></td></tr>
<tr class="separator:aad89a7b4e5adb8613efe6fa04700598a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains module <a class="el" href="namespacepchelms.html">pchelms</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
